GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG)GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGot“inÜrg˜no˜refe
«renceGs,˜exact•Uly˜on“e˜refe
«rence,˜an“d˜t“w“o˜or˜more¡‘,  refe
«renceGs.–¿óSimpãle“a•¸ãbqstract“ions›¿ólik“e˜t•Uh“eGs1Çe˜are˜rouÜrt“in“ely˜us1ÇeGd˜in˜exi#st“inÜrg˜Hask“ell¡‘,  compile
«rs‘  [Con91‘Ç!,‘¬úPJ93‘Å].–¬úThš¸ãe“s#impãliñÆcit˜y“of“t•Uh˜e“a˜bqstract˜ions“mÃak˜eGs“t•Uh˜eGsš1Çe“anÃalys˜eGs¡‘,  c•¸ãh“eqap›UUan“d˜relia“bãle,˜so˜w“e˜sh“all˜not˜cons#idÕTe
«r˜t•Uh“em˜furt•Uh“e
«r.Ÿ+«‘; A‘¬ªmore›¬ÁpGo•¸ãw“e
«rful˜anÃalys•#i“s˜migh•¸ãt˜aÀ tŸÿtµUempt˜tÜro˜giv“e˜dÕTet“aileGd˜informÃaÀ t“ion˜a“bGouÜrt¡‘,  fu•Ürnct¸ãions›Á?dÕTeqalin“g˜wit•Uh˜stru•¸ãct“ureGd˜t“yp#eGs˜su“c“h˜as˜li#stà s,˜treeGs,˜or˜wh“aÀ tµUev“e
«r˜program-¡‘,  mš¸ãe
«rs–7^care“tÜro“dÕTen˜e.“LaÀ tŸÿt˜iñÆceGs“a˜bqstract˜inÜrg“su˜c˜h“t˜yp#eGs“gro˜w“in“accordÜrance“witš•Uh“t˜h¸ãe¡‘,  compãlexitš¸ãy–apof“t•UhÃoqs1Çe“t˜yp#eGs,“so“t•Uh˜e
«re“iš#s“no“arbitrary“cu•Ürt“o–appGoin±Çt“b˜ey•¸ãon“d‘apwhiñÆc“h¡‘,  all–LDdÕTetš¸ãails“are“ignoreGd.“In“ot•Uh˜e
«r“w˜ords,“t•Uh˜e
«re“iš#s“a“pGo•qs“s˜ibilit¸ãy–LDof“s1ÇeeGinÜrg“arbitrar*«ily¡‘,  f•#ar›œô\ins“idÕTe"˜dÜraÀevš¸ãels“of“\in±ÇtµUe
«rv˜eninÜrg"“t˜yp#eGs.“Man˜y“programs“also“empãlo˜y“m•UuÜrt˜ually¡‘R  recursš#iv•¸‘,  vš¸ãe
«ry–&Çlarge,“so“t•Uh˜e“anÃalys•#i“s‘&Çb“ecom˜eGs‘&Çexp“ens“iv˜e.–&ÇIn“t•Uhi#s“s•1Çens“e,‘&Çs“em•Ãan±Çt˜iñÆc›&Çan“alys•#i“s˜i“s¡‘,  a–”Qpartš¸ãiñÆcularly“in±Çtract˜a˜bšãle“prob˜lem,“b#ecašŸÿus1Çe“t•Uh¸ãe“laÀ t˜tš¸ãiñÆce“s#izeGs“an˜d“t••Uh“us–”QamouÜrn±Çt“of¡‘,  eort–*KrequirešGd“can“gro¸ãw“exp˜on•¸ãen±Çt“ially–*Kwit•Uh“compãlexitš¸ãy“of“t˜yp#eGs.“F‘ÿ*ªor“exampãle,“if¡‘,  an–&itµUem“of“t¸ãypš#e“Á(Int,–?ıInt,“Int)–&²i˜s“mo•GdÕTelle“d–&bš¸ãy“a“9“pGoin±Çt“laÀ tŸÿt˜iñÆce,“(2–ÛWó!",š 
   
   cmsy10¸“²2“¸“²2)ŸÿóO!â…       cmsy7·?‘À²,¡‘,  addinšÜrg–B³just“on¸ãe“more“ÁInt“²t˜o“t•Uhš¸ãe“t˜upãle“eect˜iv˜ely“douš•UbãleGs“t˜hš¸ãe“laÀ tŸÿt˜iñÆce“s#ize,“giv-¡‘,  inÜrg›[f(2–ç•¸“²2“¸“²2“¸“²2)Ÿÿ·?‘À².˜Th•¸ãe˜coqstà s˜of˜high“e•
«r˜ordÕTe“r˜s1Çem•Ãan±Çt¸ãiñÆc˜an“alys1ÇeGs˜are˜almoqst¡‘,  legen¸ãd•Ürary‘ÿ*ª,›wkbu“t˜ev¸ãen˜r•s“t˜ordÕTe
«r˜anÃalys1Çe•Gs˜can˜b#ecom¸ãe˜exce“sqs•#iv¸ãely˜exp“ens“iv¸ãe.˜Get-¡‘,  t•¸ãinÜrg›…reqasonÃa“bãle˜p#e
«rformÃance˜som“et“im“e•Gs˜require“s˜\w•¸ãorà k˜limit“inÜrg"˜{˜t•Uhro“winÜrg˜aw“ay¡‘,  dÕTet•¸ãail›UUwhiñÆc“h˜a“bqstract˜in±ÇtµUe
«rpret“aÀ t“ion˜w“ould˜ot•Uh“e
«rwi#s1Çe˜piñÆc“k˜up.Ÿ!@½‘,  Ó2‘€ Cons	™train–ftÔËs–€ on“via  bÙ™le“dÆfe` s0 ignsŸÚW‘,  »2.1‘üSepara•¶ftª"e‘ÕTCompila“t®9ionŸÚW‘,  ²Cur*«iously–Ÿóenough,“s1ÇeparašÀ tµUe“compila˜tš¸ãion“i#s“t•Uh˜e“biggešGst“s#inÜrgle“source“of“dÕTe˜s#ign¡‘,  constrainš±Çtà s.‘O©A‘O§con•¸ãv“enien˜t›O©w“ay˜t•Üro˜view˜a˜m•Uul“t•¸ãi-moGd“ule˜program˜i#s˜as˜a˜directµUeGd,¡‘,  ro•GotµUe“d,›úúp“o•qs“s•#ibãly˜cycliñÆc˜graph,˜wit•Uh˜arcs˜reect¸ãinÜrg˜impGort˜dšÕTep“en•¸ãd˜encieGs,›úút•Uh“e˜ÁMain¡‘,  ²moGdš¸ãule–GåaÀ t“t•Uh˜e“\tÜro˜p",“an˜d“t•Uh˜e“Hask˜ell“ÁPrelude“²aÀ t“t•Uh˜e“bGotŸÿtÜromŸü^ÿóÙ“ R       cmr7±1‘|s².“CompilaÀ t˜ion“of“a¡‘,  mo•Gd¸ãule›³.ÁM‘³²caŸÿus1Çe“s˜t••Uh¸ãe˜compile
«r˜tÜro˜reqad˜t“h•¸ãe˜source˜tµUext˜of˜ÁM‘³²an“d˜in±ÇtµUe
«rf#ace˜leGs˜of¡‘,  mo•Gdš¸ãule“s‘‹Ğimm˜e“diaÀ tµUely–‹Ğb#elo˜w“ÁM²,“an˜d“emit“coGdÕTe“an˜d“inš±ÇtµUe
«rf#ace“leGs“for“ÁM².“In˜tµUe
«rf#ace¡‘,  lešGs–Êare“us1Çe˜d“bš¸ãy“t•Uh˜e“compile
«r“tšÜro“comm•Uu˜niñÆcaÀ tµUe“reGsul˜tà s“of“s1ÇemšÃan±Çt¸ãiñÆc“an˜alys1ÇeGs“acro•qs“s¡‘,  mo•Gdš¸ãule‘Ğb“ou•Ürn˜d“ar*«ieGs.–ĞIn“t•Uh˜e“a˜bqs1Çence“of“informÃaÀ t˜ion“a˜bšGouÜrt“imp˜ortµUe˜d“en±Çt•¸ãit“ie˜s,‘Ğt•Uh“e
«re¡‘,  i#s–âìalwš¸ãays“a“safe“asqsuÜrmpt˜ion“whiñÆc˜h“can“bš#e“mÃadÕTe.“Thi˜s“f*«ram•¸ãew“orà k›âìimp•Goqs1Çe“s˜s1Çev¸ãe
«ral¡‘,  limit•¸ãaÀ t“ions:Ÿ®¬‘2@»{‘=  ²Thš¸ãe–tin±ÇtµUe
«rf#ace“leGs“ough˜t“tšÜro“b#e“limitµUeGd“t˜o“a“reqasonÃaš¸ãbãle“s#ize,“ot•Uh˜e
«rwi#s1Çe“t•Uh˜e¡‘=  compile
«r–\fmÃay“sp#enš¸ãd“a“lot“of“t˜im˜e“reqadinÜrg“t•Uh˜em.“F‘ÿ*ªor“exampãle,“Glasgo˜w“Hask˜ell¡‘=  0.19's–®/ÁPrelude“²in±ÇtµUe
«rfš#ace“i˜s“a¸ãbGoušÜrt“100k“lon˜g,“an¸ãd“reqadin˜g“it“s#ignican±Çt•Uly“slo¸ãws¡‘=  compile
«r›UUst•¸ãart“up˜for˜smÃall˜mošGd“ule˜s.‘,  Ÿ	Ù‰  ff 8çÏŸ
LÍ‘ Ÿü-=ó)¹Aa¨       cmr6Ô1‘	?üĞIt–Ti äs“con•¾9v“enien·¤t–Ttšßo“asNsu˜mš¾9e“all“mo•AÇd˜ule“s›Timp“ort˜tTh¾9e˜ó1ß¤N  	   	   cmtt9ÜPreludeĞ.Œ‹                                         *^ gÌ\ ı¯3¤ 2Ì\ ıäÜš‘X@»{‘c  ²InformÃaÀ tš¸ãion–˜×only“o˜ws“up˜w˜ards,“tÜro˜w˜ards“ÁMain².“F‘ÿ*ªor“queGst˜ions“of“t•Uh˜e“form¤  ‘c  \hÃoš¸ãw–Q6i#s“en±Çt˜it˜y“X‘PôgoinšÜrg“t˜o“b#e“us1ÇeGd?",“wš¸ãe“also“n˜eeGd“informÃaÀ t˜ion“o˜ws“do˜wn˜w˜ard¡‘c  f*«rom‘UUÁMain².¡‘X@»{‘c  ²T‘ÿ*ªo–Äâcompile“a“moGdš¸ãule“ÁM²,“it“shÃould“suce“tÜro“reqad“t•Uh˜e“in±ÇtµUe
«rf#acešGs“for“mo˜d¸ãule˜s¡‘c  imm•¸ãeGdiaÀ tµUely›Öçb#elo“w˜ÁM².˜W‘ÿ*ªe˜ce
«rt“ainly˜w“an±Çt˜tÜro˜a“v“oid˜reqadinÜrg˜all˜t•Uh“e˜in±ÇtµUe
«rf#aceGs¡‘c  in–½t•Uhš¸ãe“do˜wn˜w˜ard“cloqsure“of“ÁM²:“for“ÁMain²,“t•Uh˜aÀ t“could“m˜ešqan“re˜adinÜrg“t•Uhš¸ãe“en±Çt˜ire¡‘c  s1Çet–UUof“in±ÇtµUe
«rf#aceGs.©û‘R  »Mu×t•®9ually›èÕrecur-s(äiv“e˜mošQÇd“ule˜s‘<;²Exi#st•¸ãinÜrg›Dæimpãlem“en±Çt“aÀ t“ions˜dÕTeqal˜wit••Uh˜m“uÜrt¸ãually¡‘R  recurs#iv•¸ãe‘cÆmošGd“ule˜s–cÆin“t•¸ãw“o›cÆw“ays.˜On“e˜i#s˜tÜro˜compile˜all˜mošGd“ule˜s–cÆin“a“group“tÜro-¡‘R  get•Uhš¸ãe
«r,–Ãa“cleqan“soãluÜrt˜ion,“as“wit•Uh“Y‘ÿ*ªale“Hask˜ell's“\compilaÀ t˜ion“uÜrnità s".“Th˜e“ot•Uh˜e
«r¡‘R  i#s–™ptÜro“compile“eqacš¸ãh“moGd˜ule“in“t•Uh˜e“group“s1ÇeparaÀ tµUely‘ÿ*ª,“uÜrn±Çt˜il“in±ÇtµUe
«rf#ace“leGs“st˜a˜bili#s1Çe,¡‘R  dÕTenot¸ãinÜrg–¥La“xešGd“p˜oin±Çt.“Thi#s“mš¸ãeqans“t•Uh˜ašÀ t“a˜t“leqast“onš¸ãe“moGd˜ule“will“h˜a˜v˜e“tÜro“b#e¡‘R  compileGd–?Nwit•Uh“ze
«ro“s1ÇemÃan±Çtš¸ãiñÆc“kno˜wleGdge“of“t•Uh˜e“ot•Uh˜e
«rs,“witš•Uh“t˜h¸ãe“compile
«r“mÃak-¡‘R  inÜrg›„{w¸ãor•s“t-cas1Çe˜asqsuÜrmpt•¸ãions.˜Th“e˜upqshÃot˜of˜t•Uhi•#s˜i“s˜t•Uh•¸ãaÀ t,˜for˜s1ÇemÃan±Çt“iñÆc˜anÃalys1ÇeGs¡‘R  in•¸ãv“oãlvinšÜrg‘UUxpGoin±Çt“in˜g,›UUt•Uh“e˜xp•Goin±Çtà s˜b#e“in•Ürg˜compu“tµUe•Gd˜mÃay˜b#e˜su•Ub“o•¸ãpt“imÃal.¦‘R  »2.2‘üCompßJletª"e–ÕTor“minimº}al“fu×nct®9ion“graphs?Ÿû‘R  ²FixpGoin±Çt•¸ãinÜrg›1]b“y˜minimÃal˜fuÜrnct“ion˜graphsŸü^ÿ±2‘	­Ğ²(MF“Gs)˜builds˜t•Uh“e˜minimÃal˜s1Çet˜of¡‘R  argu•Ürmš¸ãen±Çt-reGsul“t–ÖŒpairs“ó
 b> 
   
   cmmi10µG“²n˜ee•G÷ƒ’À;    è TeX output 1995.07.01:1517‹                                       ÿÿÿÿ gÌ\ ı¯3¤ 2Ì\ ıäÜš‘\Npó°ìK ff ff cmbx14ºBey•ïon“d›LËProtÇwot“yp8ˆe˜ImpÒÆlem“enƒŸt“aš>t“ions:¤ÌÍ‘fı>P•ïoÒÆlymorphiécc›LËPro‘ â!ject“ion˜AnŸäalys•8ˆi“s¡’ ”E.for–LËGlasgošïw“Hask˜ellŸ"Û%’ ¶3óò"V 
   
   cmbx10»Julian‘ÕTSew®9ard©  ’ ¥îóßê<x 
   
   cmtt10Ásewardj@cs.man.ac.ukŸõi’ –xzó%o´‹Ç 	   	   cmr9ĞDepart•¾9m“en·¤t–Tof“Compußtºîe	Şr“Science¤  ’ •%Viò×ctßor'xia›TUniv•¾9e	Şr”s äit“y˜of˜Manc“h“eAÇs”tºîe	Şr¡’ …ëZOxford–TRoad,“Manc•¾9h“eAÇs”tºîe	Şr–TM13“9PL,“UK.Ÿmk‘Hsçó&t‰: 	   	   cmbx9ÑA‘ÿh‰bKs’tract.‘xµĞBuildinßg›dúeect•¾9iv“e˜a“bNs”tract˜in·¤t•ºîeš	Şrpret“e˜r”s–dúrequireAÇs“careful“aÄÍt-¡‘Hsçtºîen·¤t¾9ion–RÜtßo“bAÇotšTh“t˜hš¾9eory“an˜d“en•ßgin˜ee	Şr'xin“g–RÜi äsNsueAÇs.“Th˜e“tTh˜eory“of“a˜bNs”tract¡‘Hsçin·¤tºîe	Şrpret•¾9aÄÍt“ion–®Õi äs“wš¾9ell“dØ‡ev˜elo˜p äeAÇd,“bußt“tTh˜e“en•ßgin˜ee	Şr'xin“g–®Õs äidØ‡e“h˜as“fš äallen“b˜e-¡‘Hsçhin•¾9d›q…som“ewh“aÄÍt,˜an˜ušßnfort“u˜nÈaÄÍtºîe›q…ev“en·¤t˜giv“en˜tTh“aÄÍt˜a“bNs”tract˜in·¤tºîe	Şrpret“aÄÍt“ion˜i äs¡‘HsçpAÇotºîen·¤tš¾9ially–©Öa“k˜ey“tºîec˜hnoå±logy“for“dØ‡eclaraÄÍt˜iv˜e“lanßguage“compilaÄÍt˜ion.“Thi äs¡‘Hsçpap äe	Şr–shÈoš¾9ws“tTh˜e“tThinkinßg“b äeÕ>hin˜d“tTh˜e“dØ‡eAÇs äign“an˜d“impå±lem˜en·¤t˜aÄÍt˜ion“of“a¡‘Hsçr•”s“t-ordØ‡eš	Şr,–ãÎpAÇoå±lymorphiò×c“pro‘ ƒject¾9ion“anÈalys.e˜r“for“Haskš¾9ell,“capa˜bå±le“of“dØ‡e-¡‘Hsçtºîect•¾9inßg›²h“eNad˜s”tr'xiò×ctn“eAÇsNs,˜an“d˜tTh“e	Şrefore˜suit“a“bå±le˜for˜sup“pAÇort“inßg˜all˜kno“wn¡‘Hsçs”tr'xiò×ctn¾9e•AÇsNs-relašÄÍtºîe“d–ª¹transformÈa˜tš¾9ions.“Dev˜elo˜pm˜en·¤t“culminÈaÄÍtºîeAÇd“in“a“su˜cceAÇsNs-¡‘Hsçful–PÓtr'xial“insš”t•¾9allaÄÍt“ion–PÓin“v¾9e	Şr˜s äion“0.19“of“tThš¾9e“Glasgo˜w“Hask˜ell“Compile	Şr,¡‘Hsçan•¾9d›º¥tTh“e˜sys”tºîem˜h“as˜b äeen˜us•.eAÇd˜tßo˜anÈalys“e˜a˜ranßge˜of˜Hask¾9ell˜programs,¡‘Hsçincludinßg–Tan“eNarlieš	Şr“v¾9e˜r”s äion“of“itâfs.elf,“13000“lin¾9eAÇs“lonßg.Ÿ"»Ğ‘,  ó(ÂÖN        cmbx12Ó1‘€ In–ftro` d•  u“ct“ionŸx‘,  óKñ`y 
   
   cmr10²Thš¸ãe–#ƒpast“d•ÕTecad“e–#ƒh˜as“s1Çeen“a“dramÃaÀ t˜iñÆc“impro˜v˜em˜en±Çt“in“t•Uh˜e“p#e
«rformÃance“of“lazy¦‘,  fu•Ürnct¸ãionÃal›®lan“guageGs,˜not•¸ãa“bãly˜Hask“ell,˜as˜impãlem“en±ÇtÜrors˜h“a“v“e˜dÕTev“elo“p#eGd˜w“ays˜tÜro¦‘,  mÃap›İ÷su•¸ãc“h˜lanÜrguageGs˜ecien•±Çt•Uly˜on“t•Üro˜st“oGc•¸ãk˜arc“hitµUect“ureGs.˜Nev“e
«rt•Uh“eleGsqs,˜t•Uh“ey˜st“ill¦‘,  ruÜrn–ÅÅan“ordšÕTe
«r“of“mÃagnit¸ãud˜e“slo•¸ãw“e
«r›ÅÅt•Uh“an˜t•Uh“eGir˜imp#e
«raÀ t“iv“e˜couÜrn±ÇtµUe
«rpartà s,˜an“d,˜w“ors1Çe,¦‘,  it–ÔQloGoks“likš¸ãe“t•Uh˜e“p#e
«rformÃance“impro˜v˜em˜en±Çtà s“are“t˜ailinÜrg“o.“F‘ÿ*ªurt•Uh˜e
«r“increqas1ÇeGs“in¦‘,  p•#e
«rformÃance›V´dÕTep“en•¸ãd˜on˜n“dinÜrg˜w“ays˜tÜro˜repãlace˜co“p“yinÜrg˜b“y˜upGdÜraÀ tµUe-in-pãlace,˜an“d¦‘,  lazy–œ´ev‘ÿqÇaluaÀ tš¸ãion“b˜y“str*«iñÆct“ev‘ÿqÇaluaÀ t˜ion,“wh˜en“pGo•qs“s#ibãle.–œ´A‘œ¢cr*«it˜iñÆcal“elem˜en±Çt“in“t•Uhiš#s“i˜s¦‘,  t•Uh•¸ãe›UUs1ÇemÃan±Çt“i•ñÆc˜anÃalys1ÇeGs˜whi“c•¸ãh˜di#sõTco“v“e
«r˜wh“en˜su“c“h˜transformÃaÀ t“ions˜are˜v‘ÿqÇalid.Ÿ ‘; Suš¸ãcceGsqsful–PNus1Çe“of“str*«iñÆctn˜eGsqs“an˜d“sh˜ar*«inÜrg“anšÃalys1ÇeGs“in“compile
«rs“dÕTem˜an¸ãds“care-¦‘,  ful–²cons#idÕTe
«raÀ tš¸ãion“of“t•Uh˜e“en•Ürgin˜ee
«r*«in“g–²constrain±Çtà s“imp•Goqs1Çe“d–²b˜y“s1ÇeparašÀ tµUe“compila˜t¸ãion,¦‘,  an•¸ãd›Væb“y˜t•Uh“e˜limitµUeGd˜compušÜrt“in˜g›Være•Gsource“s˜a•¸ãv‘ÿqÇaila“bãle.˜Sect“ion‘  2˜of˜t•Uhi•#s˜pap“e
«r˜exam-¦‘,  in•¸ãeGs›Yòsu“c“h˜constrain±Çtà s˜in˜dÕTet“ail,˜as˜a˜w“ay˜of˜gen“e
«raÀ t“inÜrg˜us1Çeful˜m“etr*«i•ñÆcs˜wit•Uh˜whi“c¸ãh¦‘,  tÜro›ías•qs1ÇeGs“s˜pšGo“s“s#ibilit¸ãie˜s–íin“t•Uh¸ãe“dÕTe˜s#ign“space.“Bas1Çe˜d“on“tš•Uhi#s,“w¸ãe“ouÜrt˜lin¸ãe“in“Sec-¦‘,  t•¸ãion‘  3›HÖt•Uh“e˜dÕTe•Gs#ign˜of˜a˜p“oãlymorphiñÆc,˜bac•¸ãkw“ards˜str*«iñÆctn“eGsqs˜anÃalys1Çe
«r˜for˜Hask“ell.¦‘,  Thš¸ãe–­‡anÃalys1Çe
«r“w˜as“inst˜alleGd“in“Glasgo˜w“Hask˜ell“0.19,“an˜d“shÃo˜ws“an“uÜrnpreceGdÕTen-¦‘,  tµUeGd–¹1pr*«iñÆce-p#e
«rformÃance“raÀ tš¸ãio.“Sect˜ion‘  4“preGs1Çen±Çtà s“t•Uh˜e“reGsulÜrtà s“of“t•Uhiš#s“exp˜e
«r*«imš¸ãen±Çt“an˜d¦‘,  concludÕTeGs.–RËAlÜrt•UhšÃough“our“pr*«im˜ary“conce
«rš#n“i˜s“str*«iñÆctn¸ãeGsqs“anÃalys˜i˜s“of“Haskš¸ãell,“t•Uh˜eGs1Çe¦‘,tà s˜b#e“in•Ürg˜compu“tµUe•Gd˜mÃay˜b#e˜su•Ub“o•¸ãpt“imÃal.¦‘R  »2.2‘üCompßJletª"e–ÕTor“minimº}al“fu×nct®9ion“graphs?Ÿû‘R  ²FixpGoin±Çt•¸ãinÜrg›1]b“y˜minimÃal˜fuÜrnct“ion˜graphsŸü^ÿ±2‘	­Ğ²(MF“Gs)˜builds˜t•Uh“e˜minimÃal˜s1Çet˜of¡‘R  argu•Ürmš¸ãen
«re“st˜t•UhÃoqs1Çe˜conce
«r#n¸ãe“d˜b•¸ãy˜t•Uh“e˜s1ÇeeminÜrgly˜large¤  ‘R  gap›UUb#et•¸ãw“een˜t•Uh“e˜t•Uh“eory˜an“d˜pract“iñÆce˜of˜a“bqstract˜in±ÇtµUe
«rpret“aÀ t“ion.©w•‘a Reqal,–)Ñusaš¸ãbãle“anÃalys1ÇeGs“die
«r“f*«rom“protÜrot˜yp#e“impãlem˜en±Çt˜aÀ t˜ions“in“s1Çev˜e
«ral“w˜ays.¡‘R  Th¸ãe›N/anÃalys•#i“s˜h¸ãas˜t•Üro˜ru“n˜in˜reqasonÃa•¸ãbãle˜t“im“e˜an“d˜m“emory‘ÿ*ª,˜ev“en˜wh“en˜pre•Gs1Çen±ÇtµUe“d˜wit•Uh¡‘R  u•ÜrnreqasonÃa¸ãbãle›2oinpu“tà s;˜it˜shÃould˜\t"˜pro¸ãp#e
«rly˜in±Çt“o˜t•Uh•¸ãe˜exi#st“inÜrg˜compile
«r˜f*«ram“e-¡‘R  w¸ãorà k,›xØvi•#s-a-vi“s˜s1Çepara•À tµUe˜compila“t•¸ãion,˜an“d˜it˜shÃould˜do˜a˜go•Go“d˜job˜for˜imp“ort¸ãan±Çt¡‘R  lanÜrguage–p-feqaÀ tš¸ãureGs,“part˜iñÆcularly“suÜrm-of-proGd˜u˜ctà s“t˜yp#ešGs,“p˜oãlymorphi#sm“anš¸ãd“high˜e
«r-¡‘R  ordÕTe
«r–EÅfuÜrnctš¸ãions.“W‘ÿ*ªe“shÃort•Uly“examin˜e“t•Uh˜e“cons1ÇequenceGs“of“t•Uh˜eGs1Çe“constrain±Çtà s“in“som˜e¡‘R  dÕTet¸ãail.¦‘a Th¸ãe–eúmÃain“foGcus“of“t•Uhiš#s“pap˜e
«r“i˜s“on“global“dÕTeGs˜ign“tradÕTeos.“Bas1ÇeGd“on“t•Uh¸ãaÀ t¡‘R  di•#sõTcusqs“ion,–gğwš¸ãe“ouÜrt•Ulin˜e“a“part˜iñÆcularly“eect˜iv˜e“pGoãlymorphiñÆc“pro‘ 8ject˜ion“anÃalys1Çe
«r¡‘R  for–¢ Haskš¸ãell,“an˜d“shÃo˜w“som˜e“reGsulÜrtà s“f*«rom“it.“Th˜e“anÃalys1Çe
«r's“dšÕTeGs#ign“d˜et¸ãails“are¡‘R  b•Got•Uh›àëin±ÇtµUe
«re“st•¸ãinÜrg˜an“d˜v“oãlu•Ürminous,˜bu“t˜not˜ap•¸ãpro“pr*«iaÀ tµUe˜h“e•
«re,˜so˜refe“renceGs˜tÜro˜more¡‘R  t•UhÃorough›AtreqaÀ t•¸ãm“en±Çtà s˜are˜giv“en˜t••UhroughÃouÜrt˜{˜t“h¸ãe˜r•s“t˜pGort˜of˜call˜i#s˜proba•¸ãbãly˜t•Uh“e¡‘R  aŸÿuÜrtš•UhÃor's–UUPhD“t˜h¸ãeGs•#i“s‘  [Sew94‘8ç].Ÿ Ué‘R  »Arc•®9hitª"ect“ural‘Ü>Ov“eDrview‘-È²Thi•#s›9ôpap“e
«r˜dividÕTeGs˜s1Çem•Ãan±Çt¸ãiñÆc˜an“alys•#i“s˜systµUems˜in±ÇtÜro¡‘R  t•¸ãw“o›H¢concept“ual˜partà s:˜an˜a“bqstract˜in±Çt•µUeš
«rpret“e˜r,–H¢whiñÆcš¸ãh“gen˜e
«raÀ tµUeGs“recurs#iv˜e“equaÀ t˜ions¡‘R  o•¸ãv“e
«r›`™som“e˜domÃains,˜an“d˜a˜xpGoin±ÇtµUe
«r,˜whiñÆc“h˜remo“v“eGs˜recurs#ion˜f*«rom˜t•Uh“e˜equaÀ t“ions,¡‘R  tš•Uh•¸ãe
«reÕTb“y–×5mÃakinÜrg“t˜hš¸ãem“us1Çeful“tÜro“compile
«rs.“As“usual,“w˜e“require“t•Uh˜e“domÃains“tÜro“b#e¡‘R  of–6nitšµUe“h•¸ãeGigh“t–6tÜro“guaran±Çt˜ee“t˜e
«rminÃaÀ tš¸ãion“of“xpGoin±Çt˜inÜrg,“an˜d“furt•Uh˜e
«r“reGstr*«iñÆct“t•Uh˜em¡‘R  tÜro–UUbš#e“di˜str*«ibuÜrt•¸ãiv“e›UUlaÀ tŸÿt“iñÆceGs˜tÜro˜mÃak“e˜xpGoin±Çt“inÜrg˜eqas#ie
«r.¦‘a Sev¸ãe•
«ral›Ğ$die“ren±Çt˜sõTc•¸ãh“em“e•Gs˜for˜xp“oin±Çt•¸ãinÜrg˜h“a“v“e˜b#een˜pro“p•Goqs1Çe“d.˜Th•¸ãe˜F‘ÿ*ªron±Çt“ie
«rs¡‘R  algor*«it•Uhm–b'clevš¸ãe
«rly“expãloità s“monotÜroniñÆcit˜y“tÜro“build“syn±Çt˜act˜iñÆcally“uÜrnique“repreGs1Çen±Çt˜a-¡‘R  t¸ãions,›© t••Uh“us˜tr*«iviali•#s“inÜrg˜t•Uh•¸ãe˜dÕTetµUect“ion˜of˜xpGoin•±Çtà s.˜In“trošGd•¸ãu“ce˜d›© b“y˜Clac“k˜an“d˜P“eytÜron¡‘R  Jon•¸ãeGs‘  [PC87‘ ],›†t•Uh“e˜algor*«it•Uhm˜h“as˜b#een˜m•Uu“c“h˜t“uÜrn“eGd˜o“v“e
«r˜t•Uh“e˜y“eqars‘  [Mar92‘Z,˜HuÜrn91‘o],¡‘R  an•¸ãd›¾sup“pGortà s˜high“e•
«r˜ordÕTe“r˜xpGoin±Çt•¸ãinÜrg.˜A‘s1Çecon“d˜lin“e˜of˜enquiry˜i#s˜t•Uh“aÀ t˜of˜lazy¡‘R  xpGoin±Çt•¸ãinÜrg,›6”wh“e
«re˜t•Uh“e˜xp•Goin±Çt˜i#s˜only˜compuÜrtµUe“d˜wh•¸ãe
«re˜n“ee•GdÕTe“d,˜on˜dÕTemÃan•¸ãd.˜Th“e¡‘R  preci#s1Çe–ù1or*«igins“of“lazy“xpGoin±Çtš¸ãinÜrg“are“d•ÕTe“baÀ t˜a˜bãle,–ù1buÜrt“t˜w˜o“eqarly“preGs1Çen±Çt˜aÀ t˜ions¡‘R  are–·Ådš¸ãue“tÜro“t•Uh˜e“Cousotà s‘  [CC78‘qÊ]“an˜d“tÜro“Jon˜eGs“an˜d“Mycroft‘  [JM86‘N=].“ExtµUens#ions¡‘R  tÜro›ğ¨high¸ãe•
«r-ordÕTe“r˜xpGoin±Çt•¸ãinÜrg˜are˜shÃo“wn˜b“y˜F‘ÿ*ªe
«rguson˜an“d˜Hugh“eGs‘  [FH93‘!],˜an“d˜b“y¡‘R  Rošqs1Çen¸ãd•Üra“hl‘  [Ro˜s93‘j­].–Î†Thš¸ãe“w˜orà k“of“Hankin“an˜d“Le“M˜‘ûGet˜ay˜e
«r“on“\lazy“t˜yp#eGs"‘  [HM94‘ª¯]¡‘R  i#s–UUalso“relaÀ tµUeGd.¦‘a In–8×t•Uhiš#s“pap˜e
«r“wš¸ãe“t˜ak˜e“a“t•Uhird“ap˜proac˜h:“compuÜrt˜aÀ t˜ion“of“compãletµUe“xpGoin±Çtà s¡‘R  b¸ãy–4öus#inÜrg“a“tšµUe
«rm“rewr*«it˜e“syst˜em“tÜro“transform“s1ÇemÃanš±Çt¸ãiñÆcally“equiv‘ÿqÇalen˜t“tµUe
«rms“tÜro¡‘R  synš±Çt•¸ãact“iñÆcally‘8|idÕTen˜t“iñÆcal–8|normÃal“forms.“Cons1Çel“dÕTe•GsõTcr*«ibš#e“s–8|a“s˜impãle“rewr*«itµUe
«r“for“t•¸ãw“o-¡‘R  p•Goin±Çt›ÚulaÀ tŸÿt¸ãiñÆce“s˜us1Çe“d˜in˜Y‘ÿ*ªale˜Hask•¸ãell‘  [Con91‘Ç!],˜an“d˜t•Uh“e˜tµUec“hnique˜w“as˜extµUen“dÕTeGd˜tÜro¡‘R  ot•Uh•¸ãe
«r›ëËlaÀ tŸÿt“iñÆceGs˜in‘  [Sew94‘8ç],˜Sect“ion˜5.˜Rewr*«itµUe-bas1Çe•Gd˜xp“oin±ÇtµUe•
«rs˜cannot,˜in˜gen¸ãe“ral,¡‘R  soãlv•¸ãe›UUhigh“e•
«r-ordÕTe“r˜equaÀ t•¸ãions,˜buÜrt,˜as˜w“e˜sh“all˜s1Çee,˜t•Uhi#s˜m•Ãay˜not˜m“aÀ tŸÿtµUe
«r˜m•Uu•¸ãc“h.¦‘a NošGc•¸ãk“e
«r‘  [No˜c93‘8è]›Ñ¶shÃo“ws˜a˜w“orà kinÜrg˜anÃalys•1Çe
«r,˜bas“e•Gd˜on˜\a¸ãbqstract˜re“d•¸ãu“ct“ion",¡‘R  whš¸ãe•
«re‘‚8tµUe“rm-rewr*«it˜inšÜrg–‚8i#s“us1ÇeGd“t˜o“execu˜tµUe“t•Uh¸ãe“program“us#in˜g“somš¸ãe“a˜bqstract“s1Çe-¡‘R  mÃan±Çt¸ãiñÆcs.–dBy“comparš*«i#son,“our“tµUe
«rm-rewr˜it¸ãinšÜrg“i#s“us1ÇeGd“t˜o“dÕTetµUect“xpGoin±Çtà s,“an¸ãd¡‘R  t•Uh¸ãe
«re–-viš#s“a“cleqar“di˜st•¸ãinct“ion‘-vb˜et“w“een›-vt•Uh“e˜a“bqstract˜in±ÇtµUe
«rpret“aÀ t“ion˜an“d˜xpGoin±Çt“inÜrg¡‘R  act•¸ãivit“ieGs.¦‘a Thš¸ãe–˜preci#s1Çe“nÃaÀ t˜ure“of“a˜bqstract“in±ÇtµUe
«rpret˜aÀ t˜ions“i#s“dÕTetµUe
«rmin˜eGd,“nÃaÀ t˜urally‘ÿ*ª,“b˜yŒ‹                                         : gÌ\ ı¯3¤ 2Ì\ ıäÜš‘,  ²t•Uh•¸ãe›¾štransformÃaÀ t“ion˜tÜro˜b#e˜sup“p•GortµUe“d.˜On•¸ãe˜part“iñÆcularly˜impGort“an±Çt˜c“h“aractµUe
«r*«i#sa-¤  ‘,  tš¸ãion–ZÄi#s“t•Uh˜e“laÀ tŸÿt˜išñÆceGs“tÜro“whi˜cš¸ãh“die
«ren±Çt“t˜yp#eGs“are“mÃap˜p#eGd.“In“t•Uh˜e“s#impãleGst“cas1Çe,¡‘,  all–RŸnon-fuÜrnctš¸ãionÃal“t˜ypš#eGs“could“b˜e“mÃap¸ãp˜ešGd“tÜro“a“t•¸ãw“o-p˜oin±Çt›RŸlaÀ tŸÿt“iñÆce,˜wit••Uh˜t“h¸ãe˜pGoin±Çtà s¡‘,  repreGs1Çen±Çtš¸ãinÜrg–Rpno“dÕTemÃan˜d“an˜d“w˜eqak“h˜eqad“normšÃal“form“(WHNF)‘RodÕTem˜an¸ãd“reGsp#ect-¡‘,  ivš¸ãely–¡šin“str*«iñÆctn˜eGsqs“anÃalys•#i“s.–¡šF‘ÿ*¡’ “s#impãle“sh˜ar*«inÜrg“anÃalys•#i“s,–¡šw˜e“migh˜t“us1Çe“a“3-¡‘,  pGoin±Çt›!äc•¸ãh“ain,˜dÕTenot“inÜrg˜no˜refe
«renceGs,˜exact•Uly˜on“e˜refe
«rence,˜an“d˜t“w“o˜or˜more¡‘,  refe
«renceGs.–¿óSimpãle“a•¸ãbqstract“ions›¿ólik“e˜t•Uh“eGs1Çe˜are˜rouÜrt“in“ely˜us1ÇeGd˜in˜exi#st“inÜrg˜Hask“ell¡‘,  compile
«rs‘  [Con91‘Ç!,‘¬úPJ93‘Å].–¬úThš¸ãe“s#impãliñÆcit˜y“of“t•Uh˜e“a˜bqstract˜ions“mÃak˜eGs“t•Uh˜eGsš1Çe“anÃalys˜eGs¡‘,  c•¸ãh“eqap›UUan“d˜relia“bãle,˜so˜w“e˜sh“all˜not˜cons#idÕTe
«r˜t•Uh“em˜furt•Uh“e
«r.Ÿ+«‘; A‘¬ªmore›¬ÁpGo•¸ãw“e
«rful˜anÃalys•#i“s˜migh•¸ãt˜aÀ tŸÿtµUempt˜tÜro˜giv“e˜dÕTet“aileGd˜informÃaÀ t“ion˜a“bGouÜrt¡‘,  fu•Ürnct¸ãions›Á?dÕTeqalin“g˜wit•Uh˜stru•¸ãct“ureGd˜t“yp#eGs˜su“c“h˜as˜li#stà s,˜treeGs,˜or˜wh“aÀ tµUev“e
«r˜program-¡‘,  mš¸ãe
«rs–7^care“tÜro“dÕTen˜e.“LaÀ tŸÿt˜iñÆceGs“a˜bqstract˜inÜrg“su˜c˜h“t˜yp#eGs“gro˜w“in“accordÜrance“witš•Uh“t˜h¸ãe¡‘,  compãlexitš¸ãy–apof“t•UhÃoqs1Çe“t˜yp#eGs,“so“t•Uh˜e
«re“iš#s“no“arbitrary“cu•Ürt“o–appGoin±Çt“b˜ey•¸ãon“d‘apwhiñÆc“h¡‘,  all–LDdÕTetš¸ãails“are“ignoreGd.“In“ot•Uh˜e
«r“w˜ords,“t•Uh˜e
«re“iš#s“a“pGo•qs“s˜ibilit¸ãy–LDof“s1ÇeeGinÜrg“arbitrar*«ily¡‘,  f•#ar›œô\ins“idÕTe"˜dÜraÀ t•¸ãa˜stru“ct“ureGs.˜Th“e˜do“wns•#idÕTe˜i“s˜t••Uh¸ãaÀ t˜t“h•¸ãeGs1Çe˜laÀ tŸÿt“iñÆceGs˜can˜an“d˜do˜get¡‘,  vš¸ãe
«ry–&Çlarge,“so“t•Uh˜e“anÃalys•#i“s‘&Çb“ecom˜eGs‘&Çexp“ens“iv˜e.–&ÇIn“t•Uhi#s“s•1Çens“e,‘&Çs“em•Ãan±Çt˜iñÆc›&Çan“alys•#i“s˜i“s¡‘,  a–”Qpartš¸ãiñÆcularly“in±Çtract˜a˜bšãle“prob˜lem,“b#ecašŸÿus1Çe“t•Uh¸ãe“laÀ t˜tš¸ãiñÆce“s#izeGs“an˜d“t••Uh“us–”QamouÜrn±Çt“of¡‘,  eort–*KrequirešGd“can“gro¸ãw“exp˜on•¸ãen±Çt“ially–*Kwit•Uh“compãlexitš¸ãy“of“t˜yp#eGs.“F‘ÿ*ªor“exampãle,“if¡‘,  an–&itµUem“of“t¸ãypš#e“Á(Int,–?ıInt,“Int)–&²i˜s“mo•GdÕTelle“d–&bš¸ãy“a“9“pGoin±Çt“laÀ tŸÿt˜iñÆce,“(2–ÛWó!",š 
   
   cmsy10¸“²2“¸“²2)ŸÿóO!â…       cmsy7·?‘À²,¡‘,  addinšÜrg–B³just“on¸ãe“more“ÁInt“²t˜o“t•Uhš¸ãe“t˜upãle“eect˜iv˜ely“douš•UbãleGs“t˜hš¸ãe“laÀ tŸÿt˜iñÆce“s#ize,“giv-¡‘,  inÜrg›[f(2–ç•¸“²2“¸“²2“¸“²2)Ÿÿ·?‘À².˜Th•¸ãe˜coqstà s˜of˜high“e•
«r˜ordÕTe“r˜s1Çem•Ãan±Çt¸ãiñÆc˜an“alys1ÇeGs˜are˜almoqst¡‘,  legen¸ãd•Ürary‘ÿ*ª,›wkbu“t˜ev¸ãen˜r•s“t˜ordÕTe
«r˜anÃalys1Çe•Gs˜can˜b#ecom¸ãe˜exce“sqs•#iv¸ãely˜exp“ens“iv¸ãe.˜Get-¡‘,  t•¸ãinÜrg›…reqasonÃa“bãle˜p#e
«rformÃance˜som“et“im“e•Gs˜require“s˜\w•¸ãorà k˜limit“inÜrg"˜{˜t•Uhro“winÜrg˜aw“ay¡‘,  dÕTet•¸ãail›UUwhiñÆc“h˜a“bqstract˜in±ÇtµUe
«rpret“aÀ t“ion˜w“ould˜ot•Uh“e
«rwi#s1Çe˜piñÆc“k˜up.Ÿ!@½‘,  Ó2‘€ Cons	™train–ftÔËs–€ on“via  bÙ™le“dÆfe` s0 ignsŸÚW‘,  »2.1‘üSepara•¶ftª"e‘ÕTCompila“t®9ionŸÚW‘,  ²Cur*«iously–Ÿóenough,“s1ÇeparašÀ tµUe“compila˜tš¸ãion“i#s“t•Uh˜e“biggešGst“s#inÜrgle“source“of“dÕTe˜s#ign¡‘,  constrainš±Çtà s.‘O©A‘O§con•¸ãv“enien˜t›O©w“ay˜t•Üro˜view˜a˜m•Uul“t•¸ãi-moGd“ule˜program˜i#s˜as˜a˜directµUeGd,¡‘,  ro•GotµUe“d,›úúp“o•qs“s•#ibãly˜cycliñÆc˜graph,˜wit•Uh˜arcs˜reect¸ãinÜrg˜impGort˜dšÕTep“en•¸ãd˜encieGs,›úút•Uh“e˜ÁMain¡‘,  ²moGdš¸ãule–GåaÀ t“t•Uh˜e“\tÜro˜p",“an˜d“t•Uh˜e“Hask˜ell“ÁPrelude“²aÀ t“t•Uh˜e“bGotŸÿtÜromŸü^ÿóÙ“ R       cmr7±1‘|s².“CompilaÀ t˜ion“of“a¡‘,  mo•Gd¸ãule›³.ÁM‘³²caŸÿus1Çe“s˜t••Uh¸ãe˜compile
«r˜tÜro˜reqad˜t“h•¸ãe˜source˜tµUext˜of˜ÁM‘³²an“d˜in±ÇtµUe
«rf#ace˜leGs˜of¡‘,  mo•Gdš¸ãule“s‘‹Ğimm˜e“diaÀ tµUely–‹Ğb#elo˜w“ÁM²,“an˜d“emit“coGdÕTe“an˜d“inš±ÇtµUe
«rf#ace“leGs“for“ÁM².“In˜tµUe
«rf#ace¡‘,  lešGs–Êare“us1Çe˜d“bš¸ãy“t•Uh˜e“compile
«r“tšÜro“comm•Uu˜niñÆcaÀ tµUe“reGsul˜tà s“of“s1ÇemšÃan±Çt¸ãiñÆc“an˜alys1ÇeGs“acro•qs“s¡‘,  mo•Gdš¸ãule‘Ğb“ou•Ürn˜d“ar*«ieGs.–ĞIn“t•Uh˜e“a˜bqs1Çence“of“informÃaÀ t˜ion“a˜bšGouÜrt“imp˜ortµUe˜d“en±Çt•¸ãit“ie˜s,‘Ğt•Uh“e
«re¡‘,  i#s–âìalwš¸ãays“a“safe“asqsuÜrmpt˜ion“whiñÆc˜h“can“bš#e“mÃadÕTe.“Thi˜s“f*«ram•¸ãew“orà k›âìimp•Goqs1Çe“s˜s1Çev¸ãe
«ral¡‘,  limit•¸ãaÀ t“ions:Ÿ®¬‘2@»{‘=  ²Thš¸ãe–tin±ÇtµUe
«rf#ace“leGs“ough˜t“tšÜro“b#e“limitµUeGd“t˜o“a“reqasonÃaš¸ãbãle“s#ize,“ot•Uh˜e
«rwi#s1Çe“t•Uh˜e¡‘=  compile
«r–\fmÃay“sp#enš¸ãd“a“lot“of“t˜im˜e“reqadinÜrg“t•Uh˜em.“F‘ÿ*ªor“exampãle,“Glasgo˜w“Hask˜ell¡‘=  0.19's–®/ÁPrelude“²in±ÇtµUe
«rfš#ace“i˜s“a¸ãbGoušÜrt“100k“lon˜g,“an¸ãd“reqadin˜g“it“s#ignican±Çt•Uly“slo¸ãws¡‘=  compile
«r›UUst•¸ãart“up˜for˜smÃall˜mošGd“ule˜s.‘,  Ÿ	Ù‰  ff 8çÏŸ
LÍ‘ Ÿü-=ó)¹Aa¨       cmr6Ô1‘	?üĞIt–Ti äs“con•¾9v“enien·¤t–Ttšßo“asNsu˜mš¾9e“all“mo•AÇd˜ule“s›Timp“ort˜tTh¾9e˜ó1ß¤N  	   	   cmtt9ÜPreludeĞ.Œ‹                                         *^ gÌ\ ı¯3¤ 2Ì\ ıäÜš‘X@»{‘c  ²InformÃaÀ tš¸ãion–˜×only“o˜ws“up˜w˜ards,“tÜro˜w˜ards“ÁMain².“F‘ÿ*ªor“queGst˜ions“of“t•Uh˜e“form¤  ‘c  \hÃoš¸ãw–Q6i#s“en±Çt˜it˜y“X‘PôgoinšÜrg“t˜o“b#e“us1ÇeGd?",“wš¸ãe“also“n˜eeGd“informÃaÀ t˜ion“o˜ws“do˜wn˜w˜ard¡‘c  f*«rom‘UUÁMain².¡‘X@»{‘c  ²T‘ÿ*ªo–Äâcompile“a“moGdš¸ãule“ÁM²,“it“shÃould“suce“tÜro“reqad“t•Uh˜e“in±ÇtµUe
«rf#acešGs“for“mo˜d¸ãule˜s¡‘c  imm•¸ãeGdiaÀ tµUely›Öçb#elo“w˜ÁM².˜W‘ÿ*ªe˜ce
«rt“ainly˜w“an±Çt˜tÜro˜a“v“oid˜reqadinÜrg˜all˜t•Uh“e˜in±ÇtµUe
«rf#aceGs¡‘c  in–½t•Uhš¸ãe“do˜wn˜w˜ard“cloqsure“of“ÁM²:“for“ÁMain²,“t•Uh˜aÀ t“could“m˜ešqan“re˜adinÜrg“t•Uhš¸ãe“en±Çt˜ire¡‘c  s1Çet–UUof“in±ÇtµUe
«rf#aceGs.©û‘R  »Mu×t•®9ually›èÕrecur-s(äiv“e˜mošQÇd“ule˜s‘<;²Exi#st•¸ãinÜrg›Dæimpãlem“en±Çt“aÀ t“ions˜dÕTeqal˜wit••Uh˜m“uÜrt¸ãually¡‘R  recurs#iv•¸ãe‘cÆmošGd“ule˜s–cÆin“t•¸ãw“o›cÆw“ays.˜On“e˜i#s˜tÜro˜compile˜all˜mošGd“ule˜s–cÆin“a“group“tÜro-¡‘R  get•Uhš¸ãe
«r,–Ãa“cleqan“soãluÜrt˜ion,“as“wit•Uh“Y‘ÿ*ªale“Hask˜ell's“\compilaÀ t˜ion“uÜrnità s".“Th˜e“ot•Uh˜e
«r¡‘R  i#s–™ptÜro“compile“eqacš¸ãh“moGd˜ule“in“t•Uh˜e“group“s1ÇeparaÀ tµUely‘ÿ*ª,“uÜrn±Çt˜il“in±ÇtµUe
«rf#ace“leGs“st˜a˜bili#s1Çe,¡‘R  dÕTenot¸ãinÜrg–¥La“xešGd“p˜oin±Çt.“Thi#s“mš¸ãeqans“t•Uh˜ašÀ t“a˜t“leqast“onš¸ãe“moGd˜ule“will“h˜a˜v˜e“tÜro“b#e¡‘R  compileGd–?Nwit•Uh“ze
«ro“s1ÇemÃan±Çtš¸ãiñÆc“kno˜wleGdge“of“t•Uh˜e“ot•Uh˜e
«rs,“witš•Uh“t˜h¸ãe“compile
«r“mÃak-¡‘R  inÜrg›„{w¸ãor•s“t-cas1Çe˜asqsuÜrmpt•¸ãions.˜Th“e˜upqshÃot˜of˜t•Uhi•#s˜i“s˜t•Uh•¸ãaÀ t,˜for˜s1ÇemÃan±Çt“iñÆc˜anÃalys1ÇeGs¡‘R  in•¸ãv“oãlvinšÜrg‘UUxpGoin±Çt“in˜g,›UUt•Uh“e˜xp•Goin±Ç  idÕTeqas›H=h•¸ãa“v“e˜widÕTe
«r˜ap“pãliñÆca“bilit“y˜tÜro˜all˜a“bqstract-in±ÇtµUe
«rpret“aÀ t“ion˜bas•1ÇeGd˜anÃalys“eGs˜forŒ‹                                          * gÌ\ ı¯3¤ 2Ì\ ıäÜš‘R  ²fu•Ürnct¸ãionÃal›âolan“guage•Gs,˜an¸ãd˜shÃould˜in±ÇtµUe±Çt-reGsul“t–ÖŒpairs“ó
 b> 
   
   cmmi10µG“²n˜ee•GdÕTe“d–ÖŒtÜro“ev‘ÿqÇaluaÀ tµUe“t•Uh˜e“xpGoin±Çt“aÀ t“a“sp#ecic“arguÜrm˜en±Çt¡‘R  µxŸÿót}\Ê       cmti7Åinit‘¹².–c/Thš¸ãe“init˜ial“graph“i#s“¸f²(µxŸÿÅinit‘¹µ;‘ª¨¸>²)¸gŸü^ÿ±3‘|s².“A˜t“eqac˜h“itµUe
«raÀ t˜ion,“reGsulšÜrtà s“for“all“argu˜m¸ãen±Çtà s¡‘R  in–“4t•Uhš¸ãe“curren±Çt“graph“µGŸÿó	0e—r       cmmi7´n‘	²²are“re-ev‘ÿqÇaluaÀ tµUeGd,“givinÜrg“µGŸÿ´n±+1‘‘².“Wh˜en“an“ap˜pãliñÆcaÀ t˜ion“of¡‘R  a–ùAfušÜrnct¸ãion“t˜o“som¸ãe“argu˜m¸ãen±Çt“µx“²i#s“encou˜n±ÇtµUe
«reGd,“t•Uhš¸ãe“exi#st˜inÜrg“graph“µGŸÿ´n‘j¿²i#s“s1Çeqarc˜h˜eGd¡‘R  for–sÛa“óóóóóóóóóóóóóóóóóóóóóóóóóóóóócorre•Gsp“on¸ãdinšÜrg‘sÛre“sul˜t.–sÛIf“tš•Uh¸ãaÀ t“µx“²i#s“not“preGs1Çen±Çt,“t˜hš¸ãe“reGsulÜrt“i#s“t˜ak˜en“as“¸>“²an˜d¡‘R  t•Uhš¸ãe–¼9pair“(µx;‘ª¨¸>²)“i#s“ins1Çe
«rtµUeGd“in±ÇtÜro“µGŸÿ´n±+1‘‘².“Th˜e“pro•Gce“s•qs›¼9rep#e“aÀ tà s˜uÜrn±Çt•¸ãil˜µG˜²st“a“bili#s1ÇeGs,¡‘R  whš¸ãe
«reupGon–UUµG²(µxŸÿÅinit‘¹²)“dÕTeliv˜e
«rs“t•Uh˜e“requireGd“v‘ÿqÇalue.“As“an“exampãle,“cons#idÕTe
«r:©+DıŸç¹’ Š#xóı ': 
   
   cmt¼10Äf’ š¾Ñ²::’ ¥R»[»2‘ş¢_Ÿÿ·?‘„¿Ÿó2?‘‹Ø¸!‘Ç»2‘ş¢_Ÿÿ·?‘„¿Ÿó2?‘
ÄÀ²]ŸY–Ÿ¨’ Š#xÄf‘å¬x’ š¾Ñ²=Ÿëô’ ¥R»ó ú±u 
   
   cmex10«8Ÿ	 ’ ¥R»<Ÿ ’ ¥R»:Ÿóæd’ ¯œ°¸?’7ÊsÄif’BÒ?µx–Ç²=“¸?¡’ ¯œ°Älift– òØ²(Älift“²(»0²))’ â¹È¸u‘ãˆ²(Älift‘õ«²(¸?²)–8à¸t“²(µf‘Ú§¸?²))’7ÊsÄif’BÒ?µx–Ç²=“Älift‘¼Ã²(¸?²)¡’ Ø¸àµx–ãˆ¸u“²(Älift‘õ«²(¸?²)–8à¸t“²(µf‘Ú§x²))’7ÊsÄotherwise¦‘R  ²Givš¸ãen–æµxŸÿÅinit‘Şv²=‘%_Älift‘
²(¸?²),“w˜e“h˜a˜v˜e“µGŸÿ±0‘¡Ò²=‘%_¸f²(Älift‘õ«²(¸?²)µ;‘ª¨¸>²)¸g².“Ev‘ÿqÇaluaÀ t˜inÜrg“(µf‘8îÄlift‘.™²(¸?²))“giv˜eGs¡‘R  reGsulÜrt‘ÁêÄlift– òØ²(Älift“²(»0²))‘4½danš¸ãd–Áêa“n˜ew“pair“(¸?µ;›ª¨¸>²),“so“µGŸÿ±1‘C‹²=‘Ç¸f²(¸?µ;˜¸>²)µ;˜²(Älift‘õ«²(¸?²)µ;˜Älift– òØ²(Älift“²(»0²)))¸g².¡‘R  ItµUe
«raÀ tš¸ãinÜrg–4Üagain“giv˜eGs“µGŸÿ±2‘
b¾²=‘æK¸f²(¸?µ;–ª¨¸?²)µ;“²(Älift‘õ«²(¸?²)µ;“Älift– òØ²(Älift“²(»0²)))¸g–4Ü²an˜d“µGŸÿ±3‘
b¾²=‘æKµGŸÿ±2‘|s²,“so¡‘R  µG²(µxŸÿÅinit‘¹²)–Ç=“Älift‘¼Ã²(Älift‘õ«²(0)).¡‘a In–Dtš•Uhi#s“exampãle,“t˜hš¸ãe“requireGd“answ˜e
«r“w˜as“obt˜ain˜eGd“b˜y“ev‘ÿqÇaluaÀ t˜inÜrg“µf‘Wª²aÀ t“t˜w˜o¡‘R  oušÜrt–Æof“ità s“four“argu˜m¸ãenš±Çt“pGoin˜tà s.“Whš¸ãen“t•Uh˜e“arguÜrm˜en±Çt“laÀ tŸÿt˜iñÆceGs“con±Çt˜ain“t•UhÃousan˜ds¡‘R  of–]­pGoin±Çtà s,“t•Uhš¸ãe“hÃo˜pš#e“i˜s“t•Uhš¸ãaÀ t“only“a“t˜in˜y“minor*«it˜y“of“argu•Ürm˜en±Çt-reGsul“t–]­pairs“n˜eeGd“tÜro¡‘R  b#e‘UUcompuÜrtµUeGd.¡‘a MF•¸ãGs›h>ac“hiev“e˜\lazy"˜xpGoin±Çt“inÜrg˜b#ecaŸÿus1Çe˜t•Uh“ey˜mÃak“e˜expãliñÆcit˜t•Uh“e˜dšÕTep#en“d˜ence¡‘R  b#et•¸ãw“een–?inpušÜrt“an¸ãd“ou˜tÊªpu˜t“pGoin±Çtà s.“Notš¸ãiñÆce“hÃo˜w“t•Uh˜e“algor*«it•Uhm“i#s“limitµUeGd“tÜro“r•s“t‘R  ŸŸ«‰  ff 8çÏŸ
LÍ‘ Ÿü-=Ô2‘	?üĞA–Tfußnctš¾9ion's“graph“i äs“no“more“tTh˜an“a“coå±llect˜ion“of“argu•ßm˜en·¤t-reAÇsul“t–Tpair”s“for“it.Ÿ ‘ Ÿü-=Ô3‘	?üó,©±Ê 	   	   cmsy9×>–TĞif“m•Èaxim“al–TxpšAÇoin·¤tâfs“are“sough¾9t,“×?“Ğfor“minimÈal“xp˜oin·¤tâfs.Œ‹                                         @¨ gÌ\ ı¯3¤ 2Ì\ ıäÜš‘,  ²ordÕTe
«r–ª6fuÜrnctš¸ãions:“high˜eš
«r“ordÕTe˜r“xpGoin±Çtš¸ãinÜrg“w˜ould“require“compar*«inšÜrg“compãletµUe“fu˜nc-¤  ‘,  t•¸ãion›ƒ‚repreGs1Çen±Çt“aÀ t“ions,˜whiñÆc“h˜i•#s˜preci“s1Çely˜wh•¸ãaÀ t˜lazy˜xpGoin±Çt“inÜrg˜i•#s˜dÕTešGs“ign¸ãe˜d–ƒ‚tÜro“a•¸ãv“oid.¡‘,  Nev•¸ãe
«rt•Uh“eleGsqs,›‡Åb“y˜extµUen“dinÜrg˜t•Uh“e˜not“ion˜of˜dšÕTep#en“d˜ency›‡Åb#et“w“een˜inpuÜrtà s˜an“d˜ou•ÜrtÊªpu“tà s,¡‘,  F‘ÿ*ªe
«rguson–	anš¸ãd“Hugh˜eGs‘  [FH93‘!]“h˜a˜v˜e“su˜cceGsqsfully“gen˜e
«rali#s1ÇeGd“MF˜Gs“tÜro“w˜orà k“in“t•Uh˜e¡‘,  high¸ãe•
«r›T’ordÕTe“r˜cas1Çe,˜callin•Ürg˜t•Uh¸ãem˜concretµUe˜d“aÀ t•¸ãa˜stru“ct“ureGs˜(CDSs),˜an“d˜Roqs1Çen“d•Üra“hl¡‘,  repšGortà s–UUs#imilar“re˜sulÜrtà s‘  [Roqs93‘j­].¡‘; F‘ÿ*ªuÜrnct•¸ãionÃal›6t“yp#eGs˜a“bqstract˜tÜro˜dom•Ãains˜wit•Uh˜so˜m“an•¸ãy˜pGoin±Çtà s˜t•Uh“aÀ t˜lazy˜xpGoin±Çt-¡‘,  inÜrg–pÂcan“mÃakš¸ãe“an“enormous“die
«rence“for“high˜eš
«r“ordÕTe˜r“anÃalys•#i“s.–pÂF‘ÿ*ªe˜rguson“an¸ãd¡‘,  Hugh•¸ãeGs›UUgiv“e˜gureGs˜for˜t•Uh“e˜f#amous˜Áfoldr²-Áconcat˜²exampãle:©‘³‘;¿÷Áfoldr–?ı::“(a“->“b“->“b)“->“b“->“[a]“->“b¡¡‘;¿÷foldr–?ıf“a“[]“=“a¡‘;¿÷foldr–?ıf“a“(x:xs)“=“f“x“(foldr“f“a“xs)¡¡‘;¿÷concat–?ı::“[[a]]“->“[a]¡‘;¿÷concat–?ı=“foldr“(++)“[]¦‘,  ²whš¸ãe
«re–ŸPÁ(++)“²i#s“t•Uh˜e“Hask˜ell“li•#st-ap˜p“en˜d‘ŸPo˜p“e
«raÀ tšÜror.‘ŸPUs“in˜g–ŸPa“BHA-stš¸ãyle“forw˜ard“a˜b-¡‘,  stract›¦µin±ÇtµUe
«rpret•¸ãaÀ t“ion‘  [BHA85‘ []˜requireGs˜buildinÜrg˜an˜inst“ance˜of˜Áfoldr˜²in˜t•Uh“e˜do-¡‘,  mÃain›=Ô[»4–J•¸!“»4“¸!“»4²]“¸!“»4“¸!“»6“¸!“»4².˜Thi#s˜giv•¸ãeGs˜an˜arguÜrm“en±Çt˜laÀ tŸÿt“iñÆce˜of˜almoqst¡‘,  600,000–Ø1pGoinš±Çtà s.“CompuÜrt•¸ãaÀ t“ion–Ø1of“t•Uh¸ãe“en˜tš¸ãire“fuÜrnct˜ion“graph“t˜ak˜eGs“on“t•Uh˜e“ordÕTe
«r¡‘,  of–•Gan“hÃour“us#inÜrg“t•Uhš¸ãe“f*«ron±Çt˜ie
«rs“algor*«it•Uhm‘  [FH93‘!],“wh˜e
«reqas“wit•Uh“CDSs“compu•Ürt˜in“g¡‘,  just–œ#t•UhÃoqs1Çe“partà s“n¸ãee•GdšÕTe“d–œ#tÜro“d˜etµUe
«rminš¸ãe“t•Uh˜e“en±Çt˜ire“xpGoin±Çt“of“Áconcat“²t˜ak˜eGs“t˜w˜o“or¡‘,  t•Uhree–¬	s1Çeconš¸ãds“uÜrn˜dÕTe
«r“s#imilar“circuÜrmst˜anceGs.“F‘ÿ*ªor“more“compãlex“fuÜrnct˜ion“spaceGs“t•Uh˜e¡‘,  dieš
«rence–UUi#s“ev¸ãen“greqaÀ tµUe˜r.¡‘; Giv•¸ãen›"su“c“h˜an˜o“v“e
«rwh“elminÜrg˜p#e
«rformÃance˜adv‘ÿqÇan±Çt“age,˜it˜i#s˜tµUempt“in•Ürg˜t“o˜for-¡‘,  get– en±Çtš¸ãirely“a˜bGouÜrt“an˜y“ot•Uh˜e
«r“xpGoin±Çt˜inÜrg“sõTc˜h˜em˜e.“Y‘ÿ*ªet“in±ÇtµUegraÀ t˜ion“of“CDS‘ qbas1ÇeGd¡‘,  xpšGoin±Çt•¸ãinÜrg‘.+pro“v“e˜s‘.+trou•Ubãle˜som“e›.+wh“en˜view“eGd˜f•*«rom˜a˜widÕTe
«r˜f“ram•¸ãew“orà k.˜Th“e
«re˜are¡‘,  t•¸ãw“o›ˆÚas-y“et˜uÜrnrešGsoãlv“e˜d–ˆÚi#sqsue˜s.“Fir•s“t•Uly‘ÿ*ª,–ˆÚas“di#sõTcusqs1Çe˜d“b#eloš¸ãw,“w˜e“h˜a˜v˜e“a“dšÕTeep“d˜eGs#ire¡‘,  tÜro›ŞQa•¸ãv“oid˜monomorphiñÆc˜anÃalys1ÇeGs˜of˜an“y˜kin“d.˜CDSs˜as˜pre•Gs1Çen±ÇtµUe“d˜so˜f#ar˜are˜purely¡‘,  monomorphiñÆc.–;¯BecaŸÿus1Çe“of“t•Uhš¸ãe“n˜eešGd“tÜro“cloqs1Çely“exp˜oqs1Çe“d•ÕTep#en¸ãd“encie˜s›;¯b#et•¸ãw“een˜su•Ub-¡‘,  partà s–©¿of“t•Uhš¸ãe“inpuÜrt“an˜d“suš•Ub-partà s“of“t˜hš¸ãe“ou•ÜrtÊªpu“t,–©¿it“i#s“not“cleqar“hÃo˜w“t•Uh˜ey“mÃay“b#e¡‘,  us1ÇešGd–ı,in“a“p˜oãlymorphiñÆc“w¸ãay›ÿ*ª.“F˜or“r•s“t-ordÕTe
«r‘ı,MFš¸ãG-s“t˜yle–ı,xpGoin±Çt˜inÜrg,“pGoãlymorph-¡‘,  i•#sm›Q¹i“s˜not˜a˜probãlem:˜K•¸ãu•Ubiak‘  [KHL91‘‡"]˜h“as˜impãlem“en±ÇtµUe•Gd˜a˜p“oãlymorphiñÆc˜pro‘ 8ject¸ãion¡‘,  anÃalys1Çe
«r–UUwit•Uh“MFš¸ãG“xpGoin±Çt˜inÜrg“in“t•Uh˜e“Glasgo˜w“Hask˜ell“compile
«r.¡‘; A‘—Èmore–—øimm¸ãešGdiaÀ tµUe“probãlem“wit•Uh“lazy“xp˜oin±Çtš¸ãinÜrg“i#s“hÃo˜w“tÜro“dÕTeqal“wit•Uh“mo•Gd˜ule“s.¡‘,  A‘dScrudÕTe›dWsõTc•¸ãh“em“e˜i#s˜tÜro˜expGort˜wh“aÀ tµUev“e
«r˜partà s˜of˜t•Uh“e˜a“bqstract˜fuÜrnct“ion˜graph˜h“a“v“e¡‘,  b#een–{SaggregaÀ tµUeGd“whilst“compilinšÜrg“t•Uh¸ãe“dÕTenin˜g“moGd¸ãule.“If,“compilin˜g“somš¸ãe“ot•Uh˜e
«r¡‘,  moGd•¸ãule,›êt•Uh“e˜compile
«r˜n“eeGds˜tÜro˜kno“w˜t•Uh“e˜xpGoin±Çt˜aÀ t˜som“e˜pGoin±Çt˜for˜whiñÆc“h˜no¡‘,  informÃaÀ tš¸ãion–Òi#s“a˜v‘ÿqÇaila˜bãle,“it“i#s  dÕTetš¸ãails–<Óof“t•Uh˜e“param˜etµUe
«r*«i#saÀ t˜ion“raÀ t•Uh˜e
«r“compãliñÆcaÀ tµUeGd.“Thi#s“param˜etµUe
«r*«i#saÀ t˜ion,“an˜d¡‘R  t••Uh“us›UUt“h•¸ãe˜dÕTe
«r*«iv“eGd˜in±ÇtµUe
«rpret“aÀ t“ion,˜i#s˜pGoãlymorphiñÆcally˜in“v‘ÿqÇar*«ian±Çt.ŸU´‘R  »3.3‘üFixpQÇoin¦t®9in×gŸU´‘R  ²Once–—Twš¸ãe“regard“t•Uh˜e“ou•ÜrtÊªpu“t–—Tof“t•Uh˜e“a˜bqstract“in±Çt•µUeš
«rpret“e˜r–—Tas“a“tµUe˜rm“in“somš¸ãe“\a˜bqstract¡‘R  lam‘ÿ|qbGdÜra–Y$calculus",“anš¸ãd“w˜e“kno˜w“w˜e“w˜an±Çt“tÜro“compare“su˜c˜h“tµUe
«rms“for“s1ÇemÃan±Çt˜iñÆc¡‘R  equalitš¸ãy‘ÿ*ª,–Ç¶it“s1Çeems“nÃaÀ t˜ural“tÜro“in˜v˜eGst˜igaÀ tµUe“t•Uh˜e“pGo•qs“s#ibilit˜y–Ç¶of“buildinÜrg“a“s1ÇemÃan±Çt˜iñÆcs-¡‘R  preGs1Çe
«rvinšÜrg–à™transformÃaÀ t¸ãion“en˜ginš¸ãe.“W‘ÿ*ªe“giv˜e“only“t•Uh˜e“bareGst“suÜrmmÃary“h˜e
«re“{“for¡‘R  dÕTetš¸ãails,–UUs1Çee‘  [Sew94‘8ç],“Sect˜ion“4.“Som˜e“impGort˜anš±Çt“pGoin˜tà s“are:ŸD‘X@»{‘c  ²T‘ÿ*ªe
«rms–+are“builÜrt“f*«rom“a“smÃall“s1Çelectš¸ãion“of“constru˜ct˜ions.“Lam‘ÿ|qbGdÜras,“v‘ÿqÇar*«ia˜bãleGs¡‘c  an•¸ãd›Bap“pãliñÆcaÀ t“ions˜in±ÇtroGd“u“ce˜an“d˜refe
«r˜tÜro˜v‘ÿqÇar*«ia“bãleGs,˜an“d˜ap“pãly˜a“bqstract˜fuÜrnct“ions¡‘c  t••Uh“us–IŒformš¸ãeGd.“\Constru˜ct˜ionÃal"“tµUe
«rms“dÕTenot˜inÜrg“¸?²,“t•Uh˜e“lift˜inÜrg“of“som˜e“ot•Uh˜e
«r¡Goin±Çtà s˜ouÜrt˜of˜t•UhÃousan“ds˜of˜can“didÜraÀ tµUeGs.˜Thi#s¡‘R  milit¸ãaÀ tµUešGs–3Oagainst“mÃakinÜrg“go˜o˜d“ap•¸ãpro“ximÃaÀ t“ions.–3OW‘ÿ*ªors1Çe,“not“all“t•Uh¸ãe“p˜oin±Çtà s“in“µG¡‘R  ²mšÃay–•b#e“us1ÇeGd“in“m˜akinÜrg“t•Uhš¸ãe“ap˜pro˜ximÃaÀ t˜ion:“in“t•Uh˜e“exampãle“a˜bGo˜v˜e,“w˜e“are“limitµUeGd¡‘R  t•Üro›UUus#in“g˜pGoin±Çtà s˜¸f²(µy•[Ù;‘ª¨f‘Ú§y“²)–Ç¸2“µG–0¸j“µxŸÿ±3‘C‹¸v‘Çµy[Ù¸g².¡‘a A‘>ås1Çeconš¸ãd,–?!equally“u•Ürn˜eGdifyin“g‘?!soãlu“t˜ion–?!i#s“tšÜro“expGort“not“only“µG²,“bu˜t“t•Uh¸ãe“re-¡‘R  curs#ivš¸ãe–ïGdomÃain“equaÀ t˜ion“f*«rom“wh˜ence“it“cam˜e“{“or“ev˜en“t•Uh˜e“source“tµUext“whiñÆc˜h¡‘R  b#egašÀ t–dt•Uh¸ãe“equa˜tš¸ãion.“Th˜en,“wh˜en“µG“²cannot“answ˜eš
«r“a“que˜ry‘ÿ*ª,“it“i#s“extµUenš¸ãdÕTeGd,“in“t•Uh˜e¡‘R  mÃann¸ãe
«r›:ùdÕTe•GsõTcr*«ib#e“d˜aš¸ãb“o˜v˜e,–:ùas“requireGd.“If“t•Uh˜e“a˜bqstract“in±ÇtµUe
«rpret˜aÀ t˜ions“get“large,¡‘R  dš¸ãu•Ürmpin“g–®/t•Uh˜em“inš±ÇtÜro“in˜tµUe
«rfš#ace“leGs“mÃay“not“b˜e“pract¸ãiñÆcal.“Thi˜s“sõTc•¸ãh“em“e–®/also“h¸ãas“a¡‘R  more›‘xsu••Ubt“le˜w•¸ãešqakn“eGs˜s.›‘xA‘‘hcru“cial˜ins#igh“t˜i#s˜t•Uh“aÀ t˜n“dinÜrg˜t•Uh“e˜xpGoin±Çt˜of˜a˜domÃain¡‘R  equaÀ t•¸ãion›¬ĞmÃak“eGs˜it˜st“an“d˜on˜ità s˜o“wn:˜it˜no˜lonÜrge•
«r˜refe“renceGs˜an•¸ãy˜ot•Uh“e
«r˜equaÀ t“ion.¡‘R  Cons#idÕTe
«r–Í—t•Uhš¸ãe“foãllo˜winÜrg“t•Uhree“mo•Gd˜ule“s–Í—dÕTeninÜrg“recurs#iv˜e“fuÜrnct˜ions“Áf²,“Ág“²an˜d“Áh“²wit•Uh¡‘R  corre•Gsp“on•¸ãdinÜrg›UUequaÀ t“ions˜Áf#²,˜Ág#˜²an“d˜Áh#²:©¤m‘a¿÷Ámodule–?ıF(f)“where“{‘D?Ùf“=“...“f“...‘$¿ë}¡‘a¿÷module–?ıG(g)“where“{“import“F;‘¿÷g“=“...“g“...“f“...“}¡‘a¿÷module–?ıH(h)“where“{“import“G;‘¿÷h“=“...“h“...“g“...“}¦‘R  ²Du•Ürmpin“g–UUt•Uhš¸ãe“uÜrnsoãlv˜eGd“domÃain“equaÀ t˜ions“inš±ÇtÜro“in˜tµUe
«rf#ace“(Á.hi²)“lešGs“giv¸ãe˜s:¦‘a¿÷ÁF.hi:‘¿÷f#–?ı=“...“f#“...¡‘a¿÷G.hi:‘¿÷g#–?ı=“...“g#“...“f#“...¡‘a¿÷H.hi:‘¿÷h#–?ı=“...“h#“...“g#“...¦‘R  ²Wh•¸ãen›óªmoGd“ule˜ÁH‘ó²i•#s˜compileGd˜it˜mÃay˜b“e˜n•¸ãeceGsqsary˜tÜro˜extµUen“d˜t•Uh“e˜fuÜrnct“ion˜graph¡‘R  for–NôÁg#².“Th¸ãe“trouš•Ubãle“i#s“t˜hi#s“m¸ãešqans“re˜adinÜrg“in±ÇtµUe
«rf#ace“ÁF.hi“²ev¸ãen“tš•UhÃough“t˜h¸ãe“tµUext“of¡‘R  mo•Gd¸ãule›¹úÁH‘¹Ó²do#e“s˜not˜direct•Uly˜refe•
«r˜tÜro˜ÁF²:˜in˜gen¸ãe“ral,˜it˜migh•¸ãt˜b#e˜n“eceGs•qsary˜tÜro˜re“ad˜all¡‘R  in±ÇtµUe
«rf#aceGs–Øin“t•Uhš¸ãe“do˜wn˜w˜ard“cloqsure“of“ÁH².“An˜y“sõTc˜h˜em˜e“whiñÆc˜h“expGortà s“inš±ÇtÜro“in˜tµUe
«rf#ace¡‘R  le•Gs›Õœrefe
«rence“s˜t•Üro˜fu“nct•¸ãions˜in˜ot•Uh“e
«r˜mošGd“ule˜s–Õœsue
«rs“t•Uhš¸ãe“sam˜e“probãlem.“MÜre
«rely¡‘R  inlininšÜrg–?]refe
«renceGs“t˜o“ot•Uhš¸ãe
«r“equaÀ t˜ions“do#eGs“not“h˜elp,“as“t•Uhi#s“mÃak˜eGs“t•Uh˜e“in±ÇtµUe
«rf#aceGs¡‘R  con±Çt•¸ãain›UUev“e
«ryt•UhinÜrg˜b#elo“w˜t•Uh“em˜in˜t•Uh“e˜hie
«rarc“h“y‘ÿ*ª,˜an“d˜h“ence˜v“e
«ry˜large:¦‘a¿÷ÁF.hi:‘¿÷f#–?ı=“...“f#“...¡¡‘a¿÷G.hi:‘¿÷g#–?ı=“letrec“f#“=“...“f#“...‘/?åin“...“g#“...“f#“...¡¡‘a¿÷H.hi:‘¿÷h#–?ı=“letrec“f#“=“...“f#“...‘/?åin¡’ ¥ÿĞletrec–?ıg#“=“...“g#“...“f#“...‘
úin“...“g#“...“h#“...¦‘R  ²BecaŸÿusš1Çe–ÃÊof“t•Uh¸ãeGs˜e“diculÜrt¸ãiešGs,“lazy“xp˜oin±Çt¸ãinÜrg“do#e˜s“not“s1Çeem“tÜro“t“w¸ãell“in“an¡‘R  en•¸ãvironm“en±Çt›UUwh“e
«re˜s1Çepara•À tµUe˜compila“t•¸ãion˜i#s˜t•Uh“e˜norm.Ÿ¤m‘R  »2.3‘üP®9oßJlymorphišï¥c–ÕTor“Monomorphi˜c?¦‘R  ²P•¸ãaram“etr*«iñÆc–~VpGoãlymorphiš#sm“i˜s“an“impGortš¸ãan±Çt“elem˜en±Çt“of“t•Uh˜e“t˜ypš#e“systµUems“of“moGdÕTe
«r˜n¡‘R  fu•Ürnct¸ãionÃal›UUlan“guageGs.˜Giv•¸ãen˜a˜param“etr*«i•ñÆcally˜pGoãlymorphi“c˜fuÜrnct•¸ãion,˜w“e˜could:Œ‹                                         kJ gÌ\ ı¯3¤ 2Ì\ ıäÜš‘2@»{‘=  ²ReGdo–Âİt•Uhš¸ãe“anÃalys•#i“s–Âİfor“eqac˜h“die
«ren±Çt“inst˜an±Çt˜iaÀ t˜ion“of“t•Uh˜e“fuÜrnct˜ion.“Thiš#s“i˜s¤  ‘=  equiv‘ÿqÇalen±Çt–ß—tšÜro“expan¸ãdin˜g“ou˜t“t•Uh¸ãe“program“in±Çt˜o“a“coãllect¸ãion“of“monomorphiñÆc¡‘=  inst¸ãanceGs–UUbš#efore“anÃalys˜i˜s.©ÅÙ‘2@»{‘=  ²AnÃalys1Çe–&´t•Uhš¸ãe“fuÜrnct˜ion“once,“an˜d“us1Çe“pGoãlymorphiñÆc“in˜v‘ÿqÇar*«iance“reGsulšÜrtà s“t˜o“dÕTeqal¡‘=  wit••Uh›UUdie
«ren±Çt“ly˜inst•¸ãan±Çt“iaÀ tµUe•Gd˜us1Çe“s˜laÀ tµUe
«r˜on.ŸQ‹‘,  An–™æoft-quotµUeGd“di#sadv‘ÿqÇan±Çtš¸ãage“of“t•Uh˜e“form˜e
«r“ap˜proac˜h“i#s“t•Uh˜aÀ t“pGoãlymorphiñÆc“fuÜrnct˜ions¡‘,  mšÃay–ãDb#e“an˜alys1ÇeGd“m˜anš¸ãy“t˜im˜eGs,“whiñÆc˜h“i#s“w˜astµUeful.“In“t•Uh˜e“w˜or•s“t–ãDcas1Çe,“t•Uh˜e“n•UuÜrm‘ÿ|qb#e
«r“of¡‘,  inst¸ãancešGs–àcan“b#e“exp˜on•¸ãen±Çt“ial–àin“tš•Uh¸ãe“lenÜrgt˜h“of“t˜hš¸ãe“program.“Nev˜e
«rt•Uh˜eleGsqs,“su˜c˜h“b#e-¡‘,  h•¸ãa“viour–tfdoš#eGs“not“ap¸ãp˜eqar“tšÜro“oGccur.“M˜eqasuremš¸ãen±Çtà s“b˜y“Marà k“Jon˜eGs“of“s#ix“su•Ubqst˜an±Çt˜ial¡‘,  programs–6{in“t•Uhš¸ãe“Ánofib“²suitµUe‘  [P˜ar92‘qË]“suggeGst“a“t˜w˜ofoãld“increqas1Çe“in“t•Uh˜e“n•UuÜrm‘ÿ|qb#e
«r“of¡‘,  binš¸ãdinÜrg–¯groupqs‘  [Jon93‘±Ì].“F‘ÿ*ªurt•Uh˜e
«r,“only“sš#impãle“li˜st-h•¸ãan“dlin•Ürg›¯fu“nct•¸ãions˜lik“e˜Ámap˜²an“d¡‘,  Áfoldr›S¨²h•¸ãa“v“e˜a˜large˜n•UuÜrm‘ÿ|qb#e
«r˜of˜inst“anceGs,˜an“d˜su“c“h˜fuÜrnct“ions˜are˜oftµUen˜inlin“eGd˜b“y¡‘,  o•¸ãpt“imi•#s“inÜrg–°ícompile
«rs“an•¸ãyw“ay‘ÿ*ª.–°íSo“monomorphiñÆc“anšÃalys•#i“s–°ím˜ay“not“actš¸ãually“in˜v˜oãlv˜e¡‘,  m•Uu•¸ãc“h›%d“upãliñÆcaÀ t“ion˜of˜w“orà k.˜Obqs1Çe
«rv“e˜also˜t•Uh“aÀ t˜s#ince˜t•Uh“e˜a“bqstract˜in±ÇtµUe
«rpret“aÀ t“ions˜of¡‘,  t¸ãyp#eGs–×õoftµUen“mšÃapqs“m˜anš¸ãy“t˜yp#eGs“tÜro“t•Uh˜e“sam˜e“laÀ tŸÿt˜iñÆce,“monomorphi#saÀ t˜ion“on“t•Uh˜e“bas•#i“s¡‘,  of–UUlaÀ tšŸÿt¸ãiñÆceGs“ca˜us1ÇešGs“ev¸ãen“le˜sqs“expans#ion.¦‘; More–qs1Çeš
«r*«ious“i#s,“once“again,“t•Uh¸ãe“in±ÇtµUe˜ractš¸ãion“of“monomorphi#saÀ t˜ion“wit•Uh“moGd-¡‘,  ulešGs.–^RF‘ÿ*ªor“a“mo˜d¸ãule“ÁM‘^O²exp˜ort¸ãinÜrg“a“p˜oãlymorphiñÆc“fuÜrnctš¸ãion“Áf²,“w˜e“can“eGit•Uh˜e
«r“anÃalys1Çe¡‘,  Áf–îÉ²aÀ t“all“t•Uhš¸ãe“inst˜ancešGs“it“will“get“us1Çe˜d“aÀ t,“or“wš¸ãe“can“w˜ait“uÜrn±Çt˜il“all“mo•Gd˜ule“s‘îÉa˜b“o˜v˜e‘îÉÁM¡‘,  ²are–¼³compileGd“anš¸ãd“reqanÃalys1Çe“Áf“²on“an“as-n˜ee•GdÕTe“d›¼³bas•#i“s.˜Bot•Uh˜sõTc•¸ãh“em“eGs˜are˜uÜrnÃaÀ tŸÿtract-¡‘,  iv•¸ãe,›æÏt•Uh“e˜r•s“t˜b#ecaŸÿus1Çe˜it˜requireGs˜a˜do•¸ãwn“w“ard˜(ÁMain˜²tÜro˜ÁPrelude²)˜pasqs˜t••Uhrough˜t“h¸ãe¡‘,  mošGd¸ãule–ìggraph“tÜro“e˜sšt•¸ãa“bãli#sh‘ìgins˜t“an±Çt“iaÀ t“ions,›ìgt•Uh“e˜s1Çecon“d˜b#ecaŸÿus1Çe˜of˜t•Uh“e˜n“eeGd˜tÜro˜carry¡‘,  arouÜrnš¸ãd–UUÁf²'s“source“tµUext“wh˜en“compilinÜrg“mo•Gd˜ule“s‘UUa˜b“o˜v˜e‘UUÁM².¦‘; P¸ãoãlymorphiñÆc›\ÓanÃalys•#i“s˜circuÜrm•¸ãv“en±Çtà s˜bGot•Uh˜probãlems˜b•#ecaŸÿus1Çe˜a˜s“inÜrgle˜anÃalys“i“s¡‘,  s1Çeš
«rv¸ãeGs–È[all“que˜rš*«ieGs,“ev¸ãen“t•UhÃoqs1Çe“f˜rom“die
«ren±Çt“mo•Gdš¸ãule“s.–È[W‘ÿ*ªorà k“b˜y“Baraki,“Hugh˜eGs¡‘,  an•¸ãd›mLaŸÿuÜrnc“h“bury‘  [Bar93‘ ,˜HL92b‘!»X]˜(tÜro˜m“en±Çt“ion˜buÜrt˜a˜few)˜h“as˜ešGst“a“bãli#sh“e˜d‘mtµUec“h-¡‘,  niquešGs–0#for“b˜ot•Uh“forwš¸ãard“an˜d“bac˜kw˜ard“pGoãlymorphišñÆc“str*«i˜ctn¸ãešGsqs“anÃalys1Çe˜s.“Bac¸ãk-¡‘,  wš¸ãard–¯%anÃalys1ÇeGs“len˜d“t•Uh˜ems1Çelv˜eGs“part˜iñÆcularly“w˜ell“tÜro“su˜c˜h“an“ap˜proac˜h:“Sect˜ion“5¡‘,  of‘  [Sew94‘8ç]›ËdÕTe•GsõTcr*«ib#e“s˜su•¸ãc“h˜an˜anÃalys•#i“s˜in˜cons“id•ÕTe
«ra¸ãbãle˜d“et•¸ãail.˜Baraki's˜w“orà k˜in“diñÆc-¡‘,  aÀ tµUeGs–ÕşhÃoš¸ãw“som˜e“forw˜ard“anšÃalys1ÇeGs“m˜ay“b#e“m˜adÕTe“pGoãlymorphiñÆc:‘  [Sew94‘8ç],“Sect¸ãion“3¡‘,  dÕTe•GsõTcr*«ib#e“s–UUan“impãlem•¸ãen±Çt“aÀ t“ion.¦‘; F‘ÿ*ªor›œdr•s“t˜ordÕTe
«r˜fuÜrnct•¸ãions,˜pGoãlymorphiñÆc˜tµUec“hniqueGs˜giv“e˜t•Uh“e˜sam“e˜reGsulÜrtà s˜as¡‘,  monomorphiñÆc›82anÃalys•#i“s:˜t••Uh¸ãey˜are˜exact.˜BuÜrt˜in˜t“h•¸ãe˜high“e•
«r˜ordÕTe“r˜cas1Çe,˜accuracy¡‘,  mšÃay–äÍb#e“loqst.“F‘ÿ*ªor“bac•¸ãkw“ard–äÍan˜alys1ÇeGs,“whiñÆcš¸ãh“are“inh˜eš
«ren±Çt•Uly“r•s“t-ordÕTe˜r,–äÍt•Uhi#s“mÃay¡‘,  b#e›Çaccept•¸ãa“bãle.˜F‘ÿ*ªor˜ot•Uh“e
«r˜anÃalys1ÇeGs,˜t•Uh“e˜mÃagnit“udÕTe˜of˜t•Uhi#s˜probãlem˜h“as˜y“et˜tÜro˜b#e¡‘,  quan±Çt¸ãieGd.Ÿ!İ<‘,  »2.4‘üHigh®9ešDr–ÕTor“r•-s“t‘ÕTordÎîe˜r?Ÿİ<‘,  ²High¸ãe•
«r›½ordÕTe“r˜xpGoin±Çt¸ãin•Ürg˜i#s˜dicul“t˜b#eca•Ÿÿus1Çe˜t•Uh¸ãe˜laÀ t“t•¸ãiñÆce˜s#izeGs˜for˜fuÜrnct“ion˜spaceGs¡‘,  gro¸ãw–8ãso“rapidly›ÿ*ª.“F˜or“exampãle,“in“str*«iñÆctnš¸ãeGsqs“anÃalys•#i“s,–8ãan“itµUem“of“t˜yp#e“Á[Int]–?ı->“[Int]¡‘,  ²migh•¸ãt›†±a“bqstract˜tÜro˜domÃain˜[»4–\¸!“»4²],˜whiñÆc•¸ãh˜h“as˜35˜pGoin±Çtà s.˜AddinÜrg˜a˜s1Çecon“d˜para-¡‘,  mš¸ãetµUe
«r–o«of“t•Uh˜e“sam˜e“t˜yp#e“giv˜ešGs“domÃain“[»4–Ç¸!“»4“¸!“»4²],–o«wit•Uh“24,696“p˜oin±Çtà s,“an“increqas1Çe¡‘,  of›¾Úo•¸ãv“e
«r˜700˜t“im“eGs.˜Th“e˜n•UuÜrm‘ÿ|qb#e
«r˜of˜pGoin±Çtà s˜in˜[»4–võ¸!“»4“¸!“»4“¸!“»4²]˜i#s˜ce
«rt•¸ãainly˜v“e
«ryŒ‹                                         |	 gÌ\ ı¯3¤ 2Ì\ ıäÜš‘R  ²large.–ÂoManš¸ãy“fuÜrnct˜ionÃal“param˜etµUe
«rs“h˜a˜v˜e“t˜yp#ešGs“more“compãliñÆcaÀ tµUe˜d“tš•Uh¸ãan“t˜hi#s,“an¸ãd¤  ‘R  calculaÀ tš¸ãinÜrg–UUcompãletµUe“xpGoin±Çtà s“in“t•Uh˜ešGir“pre˜s1Çence“i#s“impract¸ãiñÆcal.¡‘a FixpGoin±Çt•¸ãinÜrg›øÖb“y˜tµUe
«rm˜rewr*«it“inÜrg˜som“et“im“eGs˜f#ails˜in˜t•Uh“e˜preGs1Çence˜of˜fuÜrnct“ionÃal¡‘R  paramš¸ãetµUe
«rs.–¥ In“t•Uh˜e“gen˜e
«ral“cas1Çe,“high˜eš
«r“ordÕTe˜r“equaÀ tš¸ãions“cannot“b#e“soãlv˜eGd,“b#ecaŸÿus1Çe¡‘R  t•Uh¸ãe•Gir›æxp“oin±Çtà s˜dÕTep#en•¸ãd˜on˜t•Uh“e˜xpGoin±Çtà s˜of˜t•Uh“e˜fuÜrnct“ionÃal˜param“etµUe
«rs.˜Th“e˜usual¡‘R  mš¸ãet•UhÃoGd–Õ›of“rewr*«it˜inÜrg“adjacen±Çt“ap˜pro˜ximÃaÀ t˜ions“tšÜro“normÃal“form“f#ails“t˜o“dÕTetµUect“an¡‘R  o•¸ãv“e
«rall–`xpGoin±Çt“b#ecaŸÿusš1Çe“su•Ubqs˜equenš±Çt“ap•¸ãpro“ximÃaÀ t“ions‘`con˜t“ain›`som“e˜tµUe
«rm˜in“v“oãlvinÜrg¡‘R  a–töfuÜrnctš¸ãionÃal“param˜etµUe
«r“ap˜pãlieGd“more“an˜d“more“t˜im˜ešGs.“Thi#s“o˜ccurs,“for“exampãle,¡‘R  in–UUxpGoin±Çtš¸ãinÜrg“forw˜ards“a˜bqstract˜ions“of“Áfoldr²:©HÙ‘a¿÷Áfoldr#(n)›¿÷=–?ı\f“a“xs“->“...“f“(f‘ÿô...“(f“E)“...˜)“...¡¡‘a¿÷foldr#(n+1)–?ı=“\f“a“xs“->“...“f“(f“(f“...“(f“E)“...“)“)“...¦‘R  ²whš¸ãe
«re–ÁE‘ë²i#s“som˜e“arbitrary“tµUe
«rm,“an˜d“Áfoldr#(n)“²an˜d“Áfoldr#(n+1)“²dÕTenotµUe“t˜w˜o¡‘R  adjacen±Çt›1ºap•¸ãpro“ximÃaÀ t“ions˜tÜro˜t•Uh“e˜xpGoin±Çt.˜He
«re,˜Áf˜²i#s˜a˜fuÜrnct“ionÃal˜param“etµUe
«r˜b#eGinÜrg¡‘R  wrapš¸ãp#eGd–£‚more“an˜d“more“t˜im˜eGs“arouÜrn˜d“ÁE²,“t•Uh˜e
«reÕTb˜y“mÃakinÜrg“syn±Çt˜act˜iñÆc“dÕTetµUect˜ion“of¡‘R  a–ÅúxpšGoin±Çt“imp˜o•qs“s#ibãle.–ÅúOf“cours1Çe,“if“t•Uh¸ãe“tšµUe
«rm“rewr*«it˜e
«r“i#s“extremš¸ãely“clev˜e
«r“it“can¡‘R  dÕTetµUect–¦#t•Uhš¸ãaÀ t,“for“som˜e“suit˜a˜bšãly“large“µn²,“Áf‘æ Ÿü\p´n‘¥b²=‘MÄÄx‘¡Áf‘R²,“so“it“can“rep˜lace“Áf‘3ä²(Äx‘ÄİÁf‘Ú²)“b¸ãy¡‘R  Äx‘`>1Áf‘h«à²an•¸ãd›-²t•Uh“e
«reÕTb“y˜gen“e
«raÀ tµUe˜normÃal˜forms˜whiñÆc“h˜dÕTep#en“d˜expãliñÆcit•Uly˜on˜Áf²'s˜xpGoin±Çt.¡‘R  Th¸ãe–‘prequireGd“pašÀ tŸÿtµUe
«r#n“mÃa˜t•¸ãc“hinÜrg–‘piš#s“tr*«iñÆc¸ãky“{“not“so“s˜impšãle“for“dou•Ub˜ly“recurs#iv¸ãe¡‘R  tµUe
«rms–Ø_{“anš¸ãd“w˜e“n˜eeGd“tÜro“d•ÕTecid“e–Ø_on“a“suit˜a˜bãle“µn².“Th˜e“v‘ÿqÇalue“of“µn“²dÕTep#en˜ds“on“t•Uh˜e¡‘R  fuÜrnctš¸ãion–Ü­space“in“queGst˜ion“{“cleqarly‘ÿ*ª,“w˜e“n˜eeGd“a“quiñÆc˜k“algor*«it•Uhm“for“givinÜrg“a¡‘R  go•Go“d›‚‰o•¸ãv“e
«reGst“imÃaÀ tµUe˜of˜t•Uh“e˜fuÜrnct“ion˜space's˜h“eGigh“t.˜Nielson˜an“d˜Nielson˜lošGok“e˜d‘‚‰aÀ t¡‘R  tš•Uhi#s–üprobãlem‘  [NN92‘ ],“buÜrt“t˜hš¸ãeGir“w˜orà k“can“giv˜e“exceGsqs#iv˜ely“large“e•Gst˜imÃaÀ tµUe“s–üan˜d“i#s¡‘R  of–Æ[limitµUeGd“ap•¸ãpãliñÆca“bilit“y‘ÿ*ª.–Æ[A‘Æ>more“fu•Ürnš¸ãd“am˜en±Çt˜al–Æ[probšãlem“i#s“pGo˜lymorphi#sm:“in“t•Uh¸ãaÀ t¡‘R  cas1Çe,–ã¾µn“²v‘ÿqÇar*«ieGs“witš•Uh“t˜hš¸ãe“inst˜an±Çt˜iaÀ t˜ion,“so“t•Uh˜e“not˜ion“of“compu•Ürt˜in“g–ã¾a“s#inÜrgle“v‘ÿqÇalue¡‘R  for–UUit“i#s“nons•1Çens“e.¡‘a Nev•¸ãeš
«rt•Uh“eleGsqs,–Æfor“high¸ãe˜r“ordÕTe˜r“equaÀ tš¸ãions“whiñÆc˜h“do“not“dÕTep#en˜d“on“t•Uh˜e“xpGoin±Çtà s¡‘R  of–˜1t•Uhš¸ãeGir“fuÜrnct˜ionÃal“param˜etšµUe
«rs,“t˜e
«rm“bas1ÇešGd“xp˜oin±Çtš¸ãinÜrg“w˜orà ks“w˜ell“an˜d“can“b#e¡‘R  t•UhÃousanš¸ãds–äof“t˜im˜eGs“c˜h˜eqap#e
«r“t•Uh˜an“us#inÜrg“f*«ron±Çt˜ie
«rs.“Su˜c˜h“equaÀ t˜ions“can“b#e“gen˜e
«raÀ tµUeGd,¡‘X  for–Õexampãle,“f*«rom“t•Uhš¸ãe“forw˜ards“a˜bqstract˜ions“of“Ámap“²an˜d“Áfilter“²([Sew94‘8ç],“Sect˜ion¡‘R  4.3.5).ŸHÙ‘R  »In–ÄëdšÎîefence“of“r•-s“t–Äëord˜eDr“anº}alys•(äi“s‘²Thi•#s›%«pap“e•
«r˜argueGs˜against˜high¸ãe“r˜ordÕTe“r¡‘R  anÃalys1ÇešGs.–^ÅWh¸ãen“mo˜d¸ãule˜s“are“also“t•¸ãak“en–^Åin±ÇtšÜro“accou˜n±Çt,“tš•Uh¸ãe“n˜uÜrm‘ÿ|qbš#e
«r“of“dÕTeGs˜ign“con-¡‘R  strainš±Çtà s–ó§b#ecom¸ãeGs“in˜tÜro•ãle
«raš¸ãb“le.–ó§Can“su˜c˜h“a“sštµUep“b#e“jus˜tš¸ãieGd?“W‘ÿ*ªell,“t˜ak˜en“in“a“widÕTe
«r¡‘R  con±ÇtµUext,–9:mÃayb#e.“High¸ãeš
«r“ordÕTe˜r“fuÜrnct¸ãions“dÕTefeqaÀ t“adv‘ÿqÇancešGd“co˜dÕTe“gen•¸ãe
«raÀ t“ion‘9:tµUec“h-¡‘R  niqueGs,–Zlikš¸ãe“ar*«it˜y“c˜h˜ec˜k“a˜v˜oidšÜrance,“u˜n‘ÿ|qbGo¸ãxin˜g“an¸ãd“argu˜m¸ãen±Çtà s“in“regiš#s•tµUe
«r“s,‘Zs˜ince¡‘R  t•Uh¸ãey–®™repreGs1Çen±Çt“calls“tšÜro“compãletµUely“u˜nkno¸ãwn“fu˜nct¸ãions.“A–ÿqÇugustà sqson‘  [A“ug93‘€]‘®™sug-¡‘R  geGstà s–>—t•Uhš¸ãaÀ t“callinÜrg“a“kno˜wn“fuÜrnct˜ion“coqstà s“h˜alf“as“m•Uu˜c˜h“as“callinšÜrg“an“u˜nkno¸ãwn¡‘R  on¸ãe.¡‘a Th•¸ãe›ô(Hask“ell)˜compile
«r˜comm•UuÜrnit“y˜go˜tÜro˜cons#idÕTe
«ra“b•ãle˜trou•Ub“le˜tÜro˜get˜r*«id˜of¡‘R  calls–UUtÜro“high¸ãeš
«r“ordÕTe˜r“fuÜrnct¸ãions.“F‘ÿ*ªor“exampãle:¦‘X@»{‘c  ²Simpãle–› non-recuršs#iv¸ãe“com‘ÿ|qbinÃaÀ tÜror˜s“likš¸ãe“Á(.)“²an˜d“ÁthenS‘šÑ²are“inlin˜eGd“(in“Glasgo˜w¡‘c  Hask¸ãell).Œ‹   	                                      ‘À gÌ\ ı¯3¤ 2Ì\ ıäÜš‘2@»{‘=  ²PreludÕTe–uDfuÜrnctš¸ãions“whiñÆc˜h“pasqs“fuÜrnct˜ionÃal“param˜etµUe
«rs“alonšÜrg“u˜nc•¸ãh“an˜geGd,‘uDlik“e¤  ‘=  Ámap–UU²an¸ãd“Áfoldr²,“are“ušÜrnfoãldÕTeGd“t˜o“form“sp•#eciali“s1ÇeGd›UUv¸ãe
«rs“ions˜(in˜Y‘ÿ*ªale˜Hask¸ãell).©E‘2@»{‘=  ²Ov•¸ãe
«rloadÕTeGd›üefuÜrnct“ions˜are˜sp•#eciali“s1Çe•Gd˜aÀ t˜t•Uh¸ãe“ir˜us1Çe˜inst¸ãance“s,˜aÀ t˜leqast˜wit•Uhin¡‘=  s#inÜrgle›ÚÈmo•Gd¸ãule“s˜(Glasgo•¸ãw˜an“d˜Ch“alm“e
«rs).˜Thi#s˜a“v“oids˜a˜gre•qaÀ t˜dÕTe“al˜of˜t•Uh¸ãe¡‘=  high¸ãe•
«r›uGordÕTe“r˜mÃac•¸ãhin“e
«ry˜whiñÆc“h˜i#s˜oft•µUen˜asqsošGciaÀ t“e˜d–uGwit•Uh“impãlem•¸ãen±Çt“aÀ t“ions‘uGof¡‘=  o•¸ãv“e
«rloadinÜrg.ŸÏ‘,  Nelan‘  [Nel91‘¸ç]›ìødÕTe•GsõTcr*«ib#e“s˜aÀ t˜som•¸ãe˜lenÜrgt•Uh˜tµUec“hniqueGs˜for˜wh“aÀ t˜h“e˜tµUe
«rm“eGd˜Ärstic-¡‘,  ation²:–ælt•Uhš¸ãe“aŸÿu•Ürt“omÃaÀ t˜iñÆc–ælremo˜v‘ÿqÇal“of“high˜eš
«r“ordÕTe˜r“fušÜrnct¸ãions.“Al˜t•UhÃough“con•¸ãv“e
«rs#ion‘ælof¡‘,  high¸ãe•
«r-ordšÕTe“r–iprograms“tÜro“r•s“t-ord˜eš
«r–ii#s,“in“gen¸ãe˜ral,“impGo•qs“s#ibãle,–iprogramm¸ãe˜rs,“b¸ãy¡‘,  anš¸ãd–83large,“us1Çe“high˜e•
«r-ordÕTe“r#n˜eGsqs–83in“ce
«rt˜ain“idiomÃaÀ t˜iñÆc“w˜ays“whiñÆc˜h“Äar‘ÿ}'e“²am˜enÃa˜bãle“tÜro¡‘,  r•s“t•¸ãicaÀ t“ion–ıDusš#inÜrg“Nelan's“mÃac•¸ãhin“e
«ry‘ÿ*ª.–ıDThi˜s“mÃac•¸ãhin“e
«ry‘ÿ*ª,›ıDcom‘ÿ|qbin“e•Gd˜wit•Uh˜aggre“sqs#iv¸ãe¡‘,  inlininÜrg,–´‘can“b#e“remÃarà kñÆaš¸ãbãly“eect˜iv˜e.“Ev˜en“wit•UhÃoušÜrt“us#in˜g“r•s“t•¸ãicaÀ t“ion,›´‘m•Uu“c“h˜of¡‘,  t•Uh•¸ãe›UUo“pt“imi#s1Çe•Gd˜co“d•ÕTe˜d“eqalÜrt˜wit•Uh˜ins#id“e˜Glasgo•¸ãw˜Hask“ell˜i#s˜purely˜r•s“t˜ordÕTe
«r.¦‘; F‘ÿ*ªrom–ĞAa“str*«iñÆctn¸ãešGsqs“anÃalys•#i“s–ĞAp˜oin±Çt“of“view,“r•s“t–ĞAordÕTe
«r“anÃalys•#i“s–ĞAhš¸ãas“t˜w˜o“mÃa‘ 8jor¡‘,  adv‘ÿqÇan±Çt¸ãageGs:Ÿ‘2@»{‘=  ²FixpGoin±Çt¸ãinÜrg–¸Ôiš#s“eqas˜ie
«r.“Thš¸ãe“f*«ron±Çt˜ie
«rs“algor*«it•Uhm“ruÜrns“reqasonÃa˜bãly“quiñÆc˜kly“for¡‘=  r•s“t–ñRordÕTe
«r“exampãleGs‘  ([Sew94‘8ç],“Sectš¸ãion“3),“an˜d“tšµUe
«rm“rewr*«it˜e“bas1ÇešGd“xp˜oin±Çt¸ãinÜrg¡‘=  i#s–îáguaran±ÇtµUeeGd“tšÜro“w¸ãorà k.“Compu˜t¸ãin˜g“compãletµUe“fu˜nct¸ãion“graphs“do#ešGs“not“lo˜ok¡‘=  quitµUe–Êso“bad“in“t•Uhš¸ãe“r•s“t–ÊordÕTe
«r“cas1Çe,“an˜d“doinÜrg“so“mÃak˜ešGs“mo˜d¸ãule˜s“eqas#ie
«r“tÜro¡‘=  dÕTeqal‘UUwit•Uh.¦‘2@»{‘=  ²P•¸ãoãlymorphiñÆc›6Ègen“e
«rali#saÀ t“ion˜giv“e•Gs˜exact˜re“sulÜrtà s.˜MonomorphiñÆc˜anÃalys•#i“s˜an¸ãd¡‘=  ità s–UUaÀ tŸÿtµUenš¸ãdÜran±Çt“mo•Gd˜ule-relaÀ tµUe“d–UUprobãlems“can“b#e“a˜v˜oidÕTeGd“en±Çt˜irely‘ÿ*ª.Ÿ%Š¿‘,  Ó3‘€ Th•  e›€ Defr9™iv“e•` d˜De“s0 ignŸ$Y‘,  »3.1‘üOv®9eDrviewŸ$Y‘,  ²Cons#idšÕTe
«r*«inÜrg–Ÿ—t•Uh¸ãe“d˜ešGs#ign“constrain±Çtà s,“it“lo˜oks“lik¸ãe“a“r•s“t-ordÕTe
«r,–Ÿ—p˜oãlymorphiñÆc“anÃa-¡‘,  lys•#i“s›ïcompu•Ürt¸ãin“g˜compãletµUe˜xe•Gd˜p“oin±Çtà s˜migh¸ãt˜form˜a˜p•ãlaŸÿus#ib“le˜bas•#i“s˜for˜a˜w¸ãorà kinÜrg¡‘,  systµUem,–çkso“t•Uhiš#s“i˜s“whš¸ãaÀ t“h˜as“b#een“constru˜ctšµUeGd.“A‘ÿqÇbqstract“in±Çt˜e
«rpret•¸ãaÀ t“ion‘çkprošGd“u“ce˜s¡‘,  tµUe
«rms–­âin“wh¸ãaÀ t“can“bš#e“cons˜idÕTe
«reGd“tÜro“b˜e“an“aš¸ãbqstract“lam‘ÿ|qbGdÜra-calculus,“an˜d“xpGoin±Çt-¡‘,  inÜrg–õHi#s“don¸ãe“wit•Uh“a“t•µUe
«rm-rewr*«it“e›õHsyst“em˜whiñÆc•¸ãh˜transforms˜s1ÇemÃan±Çt“iñÆcally˜equiv‘ÿqÇalen±Çt¡‘,  tµUe
«rms–UUtÜro“synš±Çt•¸ãact“iñÆcally‘UUidÕTen˜t“iñÆcal–UUnormÃal“forms.¦‘; Thš¸ãe–XŒanÃalys1Çe
«r“forms“part“of“t•Uh˜e“Glasgo˜w“Hask˜ell“compile
«r,“an˜d“o˜p#e
«raÀ tµUeGs“on“a¡‘,  dÕTe•Gsugare“d–´£Hask¸ãell“form“lošGoqs1Çely“refe
«rre˜d“tÜro“as“Core.“Core“allo¸ãws“lam‘ÿ|qb˜dÜra“tµUe
«rms,¡‘,  ap•¸ãpãliñÆcaÀ t“ions,–íalitµUe
«rals,“loGcal“binš¸ãdinÜrgs,“on˜e-lev˜el“pašÀ tŸÿtµUe
«r#n“mÃa˜t•¸ãc“hinÜrg–ía(Ácase²s)“an¸ãd“con-¡‘,  stru•¸ãctÜror›¬Òap“pãliñÆcaÀ t“ions.˜T“yp#e˜informÃaÀ t“ion˜sup“pãlieGd˜b“y˜previous˜compile
«r˜ph“as1ÇeGs¡‘,  m•¸ãeqans›ft•Uh“e˜t“yp#e˜(an“d˜h“ence˜t•Uh“e˜a“b•qstract˜domÃain)˜as“so•GciaÀ tµUe“d˜wit••Uh˜ev¸ãe
«ry˜su“b#ex-¡‘,  preGsqs•#ion›(\i“s˜kno•¸ãwn.˜Th“e˜Core˜tree˜i#s˜annot“aÀ tµUeGd˜wit••Uh˜t“h•¸ãe˜str*«iñÆctn“eGsqs˜informÃaÀ t“ion¡‘,  compu•ÜrtµUeGd,›Á^mÃakin“g˜it˜a•¸ãv‘ÿqÇaila“bãle˜tÜro˜su•Ubqs1Çequen±Çt˜transformÃaÀ t“ion˜pasqs1ÇeGs,˜an“d˜tÜro˜t•Uh“e¡‘,  in•±ÇtµUeš
«rf#ace-pr*«in“t•¸ãinÜrg‘bmÃac“hin“e˜ry‘ÿ*ª,–bso“ot•Uh¸ãe˜r“mo•Gdš¸ãule“s–bcan“kno˜w“a˜bGouÜrt“t•Uh˜e“str*«iñÆctn˜eGsqs“of¡‘,  fuÜrnctš¸ãions–UUin“t•Uhi#s“on˜e.Œ‹   
                                      ¦b gÌ\ ı¯3¤ 2Ì\ ıäÜš‘R  »3.2‘üTh•®9e›ÕTa“b µs-tract˜in¦tª"eDrpret“a¶ft“ionŸ‘³‘R  ²A‘ÿqÇbqstract›’)in±ÇtµUe
«rpret•¸ãaÀ t“ions˜for˜str*«iñÆctn“eGsqs˜anÃalys•#i“s˜h•¸ãa“v“e˜hi•#stÜror*«iñÆcally˜b“een˜caÀ tµUegor-¤  ‘R  i#s1ÇeGd–Bas“forwš¸ãard“or“bac˜kw˜ard‘  [Hug90‘>],“alÜrtš•UhÃough“t˜hš¸ãe“ap˜p#eqarance“of“relaÀ t˜ionšÃal“an˜a-¡‘R  lys1ÇeGs–û˜i#s“noš¸ãw“bãlurr*«inÜrg“t•Uh˜aÀ t“di#st˜inct˜ion.“Bac˜kw˜ard“anÃalys1ÇeGs“gen˜e
«rašÀ tµUe“informÃa˜t¸ãion¡‘R  aš¸ãbGou•Ürt‘Şáfu“nct˜ion‘Şáargu“m˜en±Çtà s–Şágiv˜en“kno˜wleGdge“of“som˜e“pro˜p#e
«rt˜y“of“t•Uh˜e“ap˜pãliñÆcaÀ t˜ion¡‘R  as–Ş›a“whÃošãle.“F‘ÿ*ªor“examp˜le,“bac•¸ãkw“ard›Ş›str*«iñÆctn“eGsqs˜anÃalys•#i“s˜of˜an˜µn²-argu•Ürm¸ãen±Çt˜fu“nct¸ãion¡‘R  prošGd•¸ãu“ce˜s–H3µn“²mÃapšqs“on¸ãe“for“e˜acš¸ãh“arguÜrm˜en±Çt,“mÃap˜pinÜrg“dÕTemÃan˜d“on“an“ap˜pãliñÆcaÀ t˜ion“tÜro¡‘R  dÕTemÃanš¸ãd–ñ»on“eqac˜h“arguÜrm˜en±Çt.“As“tš•Uhi#s“impãlieGs,“t˜hš¸ãe“fu•Ürn˜d“am˜en±Çt˜al–ñ»a˜bqstract“en±Çt˜it˜ieGs“are¡‘R  pšGoin±Çtà s–˜in“laÀ tŸÿt¸ãiñÆce˜s,“wh¸ãeš
«re“die˜renš±Çt“pGoin˜tà s“dÕTenotµUe“die
«ren˜t“dÕTemÃanš¸ãds“or“\n˜ee•GdÕTe“d-¡‘R  nš¸ãeGsqs"–’for“som˜e“dÜraÀ t˜a“stru˜ct˜ure.“It“i#s“usual“tÜro“(aÀ t“leqast“pGotµUen±Çt˜ially)“allo˜w“eqac˜h¡‘R  die
«ren±Çt–*çconcretµUe“tš¸ãyp#e“tÜro“h˜a˜v˜e“ità s“o˜wn“laÀ tŸÿt˜iñÆce“of“a˜bqstract“dÕTemÃan˜ds,“in“ordÕTe
«r“t•Uh˜aÀ t¡‘R  wš¸ãe–UUcan“do“dÕTet˜ailešGd“anÃalys1Çe˜s“wit•Uh“dÜraÀ tš¸ãa“stru˜ct˜ureGs.©PW‘a AlÜrt••UhÃough›­Ût“h¸ãe˜r•s“t˜s“tr*«iñÆctn¸ãe•Gsqs˜anÃalys1Çe“s˜w•¸ãe
«re˜of˜t•Uh“e˜forw“ards˜t“yp#e,˜laÀ tµUe
«r˜dÕTe-¡‘R  v•¸ãelo“pm“en±Çt›{Tsugge•GstµUe“d˜bac•¸ãkw“ards˜anÃalys•#i“s˜migh¸ãt˜b“e˜quiñÆc•¸ãk“e
«r˜an“d˜giv“e˜a˜s#impãle
«r¡‘R  treqaÀ t•¸ãm“en±Çt–$7of“pGoãlymorphi#sm,“anš¸ãd“pract˜iñÆcal“w˜orà k“s1Çeems“tÜro“bš#eqar“t•Uhi˜s“ouÜrt‘  ([Sew94‘8ç],¡‘R  Sectš¸ãion–íâ5).“Th˜e“few“pap#e
«rs“shÃo˜winÜrg“hÃo˜w“str*«iñÆctn˜eGsqs“informÃaÀ t˜ion“can“b#e“us1ÇeGd“tÜro¡‘R  gen¸ãeš
«raÀ t•µUe‘c&b#etŸÿt“e˜r–c&cošGdÕTe‘  [PJ93‘ñË,“Hal93‘ªG]“all“e˜it•Uh¸ãe
«r“sugge˜st“or“impãly“t•Uhš¸ãaÀ t“bac˜kw˜ards¡‘R  informÃaÀ tš¸ãion–F.i#s“wh˜aÀ t“i#s“act˜ually“us1Çeful.“T‘ÿ*ªak˜en“tÜroget•Uh˜e
«r,“t•Uh˜e“cas1Çe“for“buildinÜrg“a¡‘R  bac•¸ãkw“ards›UUa“bqstract˜in±ÇtµUe
«rpret“aÀ t“ion˜s1Çeems˜o“v“e
«rwh“elminÜrg.¦‘a Space›äblimit•¸ãaÀ t“ions˜preclud   ˜m•Uu“c“h˜di•#sõTcusqs“ion˜of˜t•Uh•¸ãe˜a“bqstract˜in±ÇtµUe
«rpret“aÀ t“ion.¡‘R  Suce–¾±it“tÜro“say“t•Uh¸ãaÀ t“it“iš#s“f˜airly“con•¸ãv“en±Çt“ionÃal:›¾±t•Uh“e˜o“v“e
«rall˜stru“ct“ure˜i•#s˜s“imilar˜tÜro¡‘R  t•Uh¸ãaÀ t›—pre•Gs1Çen±ÇtµUe“d˜b•¸ãy˜John˜Hugh“eGs˜in‘  [Hug90‘>],˜alÜrt••UhÃough˜t“h•¸ãe˜m“ec“h“ani#sm˜for˜dÕTeqalinÜrg¡‘R  wit•Uh–¸ØdÜraÀ tš¸ãa“stru˜ct˜ureGs,“cons•tru˜ctÜror“s–¸Øan˜d“cas1Çe“tµUeš
«rms“i#s“die˜ren±Çt.“As“wit•Uh“an¸ãy“purely¡‘R  bac•¸ãkw“ard›¬
anÃalys•#i“s,˜high¸ãe•
«r-ordÕTe“r˜anÃalys•#i“s˜i“s˜impGo•qs“s#ibãle,˜so˜w•¸ãe˜nÃaiv“ely˜asqsuÜrm“e˜t•Uh“aÀ t¡‘R  all–UUušÜrnkno¸ãwn“fu˜nctš¸ãions“do“not“dÕTemÃan˜d“t•Uh˜eGir“arguÜrm˜en±Çtà s“aÀ t“all.¦‘a Man•¸ãy›pbac“kw“ard˜a“bqstract˜in±ÇtµUe
«rpret“aÀ t“ions˜go˜tÜro˜a˜gre•qaÀ t˜dÕTe“al˜of˜trou•Ubãle˜tÜro˜moGdÕTel¡‘R  dÜraÀ t•¸ãa›’ƒstru“ct“ureGs˜w“ell,˜t•Uh“e
«reÕTb“y˜in“d“u“cinÜrg˜cons#idÕTe
«ra“b•ãle˜comp“liñÆcaÀ t•¸ãion˜in˜t•Uh“e˜mÃac“hin“e
«ry¡‘R  whiñÆcš¸ãh–×dÕTeqals“wit•Uh“dÜraÀ t˜a“stru˜ct˜ureGs“{“constru˜ctšÜror“fu˜nctš¸ãions“an˜d“Ácase²s.“F–ÿ*ªort˜uÜrnÃaÀ tµUely“,¡‘R  t•Uh•¸ãe›YpreGs1Çen±Çt“aÀ t“ion˜can˜b•#e˜s“impãlieGd˜b•¸ãy˜t•Uh“e˜obqs1Çe
«rv‘ÿqÇaÀ t“ion˜t•Uh“aÀ t,˜pro“vidÕTeGd˜t•Uh“e˜a“bqstrac-¡‘R  tš¸ãion–»nof“Ácase²s“an˜d“constru˜ctšÜror“fu˜nctš¸ãions“ob#eys“ce
«rt˜ain“constrain±Çtà s,“it“do#eGsn't“mÃaÀ t-¡‘R  tµUe
«r– <ašÀ t“all“wh¸ãa˜t“tš•Uh¸ãey“are.“So“t˜hš¸ãe“bac˜kw˜ards“a˜bqstract˜ion“can“bš#e“sp˜ecieGd“wit•UhÃouÜrt¡‘R  sayin•Ürg›iDan¸ãyt•Uhin“g˜m•Uu•¸ãc“h˜a“bGou•Ürt˜d“aÀ t•¸ãa˜stru“ct“ureGs.˜Su•Ubqs1Çequen±Çt˜param“etµUe
«r*«i#saÀ t“ions˜of¡‘R  it›?ïproGd•¸ãu“ce˜compãletµUe,˜w“orà kñÆa“bãle˜a“bqstract˜in±ÇtµUe
«rpret“aÀ t“ions,˜an“d˜die
«ren±Çt˜param“et-¡‘R  e
«r*«i#saÀ tš¸ãions–„7can“proGd˜u˜ce“in±ÇtµUe
«rpret˜aÀ t˜ions“givinÜrg“v˜eš
«ry“die˜ren±Çt“levš¸ãels“of“dÕTet˜ail“for¡‘R  dÜraÀ t•¸ãa›ºstru“ct“ure•Gs.˜Thi#s˜mo“d•¸ãular˜ap“proac“h˜an“d˜som“e˜param“etµUe
«r*«i#saÀ t“ions˜of˜it˜are¡‘R  dÕTev•¸ãelo“p#eGd–UUin‘  [Sew94‘8ç],“Sectš¸ãion“5;“w˜e“ouÜrt•Ulin˜e“on˜e“su˜c˜h“param˜etµUe
«r*«i#saÀ t˜ion“shÃort•Uly‘ÿ*ª.¦‘a An–Ÿ'impGortš¸ãan±Çt“feqaÀ t˜ure“of“t•Uh˜e“a˜bqstract˜ion“i#s“t•Uh˜aÀ t“suit˜a˜bãle“param˜etµUe
«r*«i#saÀ t˜ions¡‘R  prošGd•¸ãu“ce–çœp˜oãlymorphiñÆcally“in¸ãv‘ÿqÇar*«ianš±Çt“in˜tµUe
«rpret•¸ãaÀ t“ions.›çœP“oãlymorphiñÆc˜in“v‘ÿqÇar*«iance˜f#acil-¡‘R  it¸ãa•À tšµUeGs‘˜Ùs1Çepara“t˜e›˜Ùcompila“t•¸ãion,˜as˜di#sõTcusqs1ÇeGd˜in˜Sect“ion‘  2.3,˜an“d˜it˜also˜m“eqans˜t•Uh“e˜s#ize¡‘R  of–Š tµUeš
«rms“gen¸ãe˜raÀ tµUeGd“bš¸ãy“(h˜ence,“t•Uh˜e“coqst“of‘ Ç)“a˜bqstract“in±ÇtµUe
«rpret˜aÀ t˜ion“i#s“not“relaÀ tµUeGd¡‘R  tÜro–Ã6t•Uhš¸ãe“inst˜an±Çt˜iaÀ t˜ion.“Thiš#s“i˜s“in“mšÃarà k¸ãeGd“con±Çtrast“tÜro,“for“exampãle,“W‘ÿ*ªadle
«r's“or*«igin˜al¡‘R  non-a•À t‘¢*in±ÇtµUe
«rpretš¸ãa“t˜ion‘  [W‘ÿ*ªad87‘ ],–¢*in“whiñÆc˜h“a˜bqstract˜ion“of“Ácase“²expreGsqs#ions“could¡‘R  gen¸ãeš
«raÀ t•µUe‘†kt“e˜rms–†kwhÃoqs1Çe“s#izešGs“gro¸ãw“exp˜on•¸ãen±Çt“ially–†kwitš•Uh“t˜h¸ãe“s#ize“of“t˜hš¸ãe“inst˜an±Çt˜iaÀ t˜inÜrg¡‘R  t¸ãyp#eGs.¦‘a Bac•¸ãkw“ards›{str*«iñÆctn“e•Gsqs˜anÃalys1Çe“s˜w¸ãorà k,˜in˜a˜s•1Çens“e,˜b•¸ãy˜dÕTetµUect“inÜrg˜f•*«ree˜v‘ÿqÇar“ia¸ãbãleGs˜inŒ‹                                         ¹ø gÌ\ ı°3¤ 2Ì\ ıäÜš‘,  ²expreGsšqs#ions.–õœBecaŸÿus1Çe“mo˜st“v‘ÿqÇar*«iaš¸ãbãleGs“do“not“ap˜p#ešqar“f*«ree“in“mo˜st“expreGs˜s#ions,“a¤  ‘,  n•Ãaiv¸ãe›İâan“alys•#i“s˜will˜tµUen•¸ãd˜tÜro˜gen“e
«raÀ tµUe˜mÃan“y˜h•Uuge˜tµUe
«rms˜whiñÆc“h˜tr*«ivially˜reGd“u“ce˜tÜro¡‘,  ¸?²,–h®t•Uhš¸ãe“pGoin±Çt“dÕTenot˜inÜrg“ze
«ro“dÕTemÃan˜d.“St˜ill,“gen˜e
«raÀ t˜inÜrg“t•Uh˜eGs1Çe“tš•UhinÜrgs,“t˜hš¸ãen“reGd˜u˜cinÜrg¡‘,  t•Uh•¸ãem,›Õt“ak“eGs˜eort,˜an“d˜it˜pro“v“eGs˜v‘ÿqÇalua“b•ãle˜tÜro˜p“lan±Çt˜ce
«rt•¸ãain˜k“ey˜rewr*«itµUe˜ruleGs˜ins#idÕTe¡‘,  t•Uh•¸ãe›aša“bqstract˜in±Çt•µUeš
«rpret“e˜r–ašità s1Çelf“tÜro“s#idÕTešGstµUep“t•Uh¸ãe“pro˜ce˜sqs“{“a“tr*«ivial“mo˜dicaÀ tš¸ãion“tÜro“t•Uh˜e¡‘,  co•GdÕTe.›î†Incorp“oraÀ t•¸ãinÜrg˜four˜of˜t•Uh“e˜moqst˜pGo“pular˜s#impãle˜rewr*«itµUe˜ruleGs˜dramÃaÀ t“iñÆcally¡‘,  cuÜrtà s–Ât•Uhš¸ãe“s#ize“of“gen˜e
«raÀ tšµUeGd“t˜e
«rms“anš¸ãd“so“expan˜ds“t•Uh˜e“ranšÜrge“of“source“fu˜nct¸ãions“for¡‘,  whiñÆc•¸ãh›UUa“bqstract˜in±ÇtµUe
«rpret“aÀ t“ion˜can˜b#e˜don“e˜in˜reqasonÃa“bãle˜t“im“e.Ÿp‘,  »Thš®9e–ÖWHe µad-Str1iï¥ct“P˜aram˜etª"eDr1i(äsa¶ft˜ion‘LÛ²Our›nimpãlem•¸ãen±Çt“aÀ t“ion˜us1Çe•Gs˜a˜p“o•¸ãw“e
«rful¡‘,  param•¸ãetµUe
«r*«iš#saÀ t“ion‘½dÕTeGs˜ign“eGd–½tÜro“givš¸ãe“dÕTet˜ailešGd“re˜sulÜrtà s“for“t•Uhš¸ãe“v‘ÿqÇast“mÃa‘ 8jor*«it˜y“of“dÜraÀ t˜a¡‘,  dÕTeclaraÀ tš¸ãions–òËa“Hask˜ell“programm˜e
«r“could“reqasonÃa˜bãly“us1Çe.“Thiš#s“i˜s“in“con±Çtrast¡‘,  tšÜro–ÎÒt•Uh¸ãe“oft•µUen-limit“eGd–ÎÒran˜ge“of“tš¸ãyp#eGs“whiñÆc˜h“ot•Uh˜e
«r“impãlem˜en±Çt˜aÀ t˜ions“can“dÕTeqal“wit•Uh,¡‘,  som•¸ãet“im“eGs–Díjusšt“li#s˜tà s‘  [HH91‘ ],“som•¸ãet“im“eGs–Día“fulle
«r“ranšÜrge“of“d˜ašÀ t¸ãa“dÕTeclara˜tš¸ãions“wh˜e
«re¡‘,  construš¸ãct•Üror‘Ìêargu“m˜en±Çtà s–ÌêmÃay“b#e“on˜e“of“t•Uh˜e“t˜yp#e“v‘ÿqÇar*«ia˜bãleGs,“or“a“recurs#iv˜e“call“tÜro“t•Uh˜e¡‘,  t¸ãyp#e,–\	bušÜrt“not•Uhin˜g“els1Çe‘  ([Sew91‘8ç],“Sectš¸ãion“6).“Th˜e“param˜etµUe
«r*«i#saÀ t˜ion“iš#s“dÕTe•Gs˜ign¸ãe“d‘\	tÜro¡‘,  dÕTetµUect–¶.hš¸ãeqad“str*«iñÆctn˜eGsqs.“W‘ÿ*ªe“w˜an±ÇtµUeGd“tÜro“mo˜v˜e“aw˜ay“f*«rom“t•Uh˜e“protÜrot˜yp#e“st˜age“an˜d¡‘,  creqaÀ tµUe–äÍan“anÃalys•#i“s–äÍwhiñÆcš¸ãh“(1)“giv˜eGs“us1Çeful“informÃaÀ t˜ion“for,“eect˜iv˜ely‘ÿ*ª,“an˜y“(non-¡‘,  fuÜrnct•¸ãionÃally-t“yp#e•Gd)›{—co“dÕTe˜f*«ragm•¸ãen±Çt,˜an“d˜(2)˜gen“e
«ra•À tµUeGs˜informÃa“t•¸ãion˜tÜro˜sup“pGort˜all¡‘,  kno•¸ãwn›[str*«iñÆctn“e•Gsqs-relaÀ tµUe“d˜transformÃaÀ t•¸ãions˜{˜h“ence˜t•Uh“e˜n“eeGd˜for˜h“ešqad-str*«iñÆctn“eGs˜s.¡‘,  Thš¸ãe–UreGsulÜrt“i#s“t•Uh˜aÀ t“t•Uh˜e“param˜etµUe
«r*«i#saÀ t˜ion“i#s“raÀ t•Uh˜e
«r“compãliñÆcaÀ tµUeGd,“so“w˜e“will“try“an˜d¡‘,  con•¸ãv“ey›UUt•Uh“e˜eGsqs1Çen±Çt“ial˜idÕTeqas˜wit•Uh˜an˜exampãle.Ÿj‘; Th•¸ãe›e¶param“etµUe
«r*«i#saÀ t“ion˜dÕTe
«r*«iv“eGs˜f*«rom˜Bur#n's˜idÕTeqa˜of˜ev‘ÿqÇaluaÀ t“ion˜transform“e
«rs.¡‘,  [Sew91‘8ç]–Ipgen¸ãe
«rališ#s1ÇeGd“t•Uhi˜s“tšÜro“w¸ãorà k“for“a“widÕTe
«r“ran˜ge“of“d˜aÀ tš¸ãa“t˜yp#eGs,“an˜d‘  [Sew94‘8ç]¡‘,  furt•Uh•¸ãe
«r›¯extµUen“d•ÕTeGd˜it˜tÜro˜d“etµUect˜h•¸ãešqad-str*«iñÆctn“eGs˜s.–¯Let“us“consš#idÕTe
«r“li˜stà s.“Li˜sštà s“a¸ãbqs˜tract¡‘,  tÜro––Æt•Uhree“coãllect¸ãions“of“pšGoin±Çtà s:“b˜otŸÿtšÜrom“(ÁB²),“dÕTenot¸ãin˜g“no“ev‘ÿqÇaluaÀ tš¸ãion,“t•Uh˜e“s1Çet“ÁW[a]²,¡‘,  dÕTenot•¸ãinÜrg›ğ7ev‘ÿqÇaluaÀ t“ion˜tÜro˜w“eqak˜h“eqad˜normÃal˜form,˜an“d˜t•Uh“en,˜if˜a˜cons˜cell˜i#s˜pro-¡‘,  d•¸ãu“ceGd,›Î|ev‘ÿqÇaluaÀ t“ion˜of˜t•Uh“e˜r•s“t˜elem•¸ãen±Çt˜wit•Uh˜Áa²,˜an“d˜t•Uh“e˜s1Çet˜ÁS[a][b]²,˜dÕTenot“inÜrg¡‘,  ev‘ÿqÇaluaÀ tš¸ãion–4²of“t•Uh˜e“compãletµUe“stru˜ct˜ure“of“t•Uh˜e“li#st,“ev‘ÿqÇaluaÀ t˜ion“of“t•Uh˜e“r•s“t‘4²elem˜en±Çt¡‘,  witš•Uh–Áa“²an¸ãd“all“t˜h¸ãe“reGst“wit˜h“Áb².“If“w¸ãe“moGdÕTel“in±ÇtµUege
«rs“wit˜h“t˜hš¸ãe“t˜w˜o“ev‘ÿqÇaluaÀ tÜrors“Á0¡‘,  ²(no-ev›ÿqÇal)–UUan¸ãd“Á1“²(ev˜al),“t•Uhš¸ãe“laÀ tŸÿt˜iñÆce“for“Á[Int]“²b#ecom˜eGs:ŸY©’ Ù?ÁS[1][1]¡’ Óÿ /‘$¿ë\¡’ ¹¿¯S[1][0]‘?ñS[0][1]¡’ ¾ÿ¬/‘ÿô\‘î/¡’ ©ÿ¸W[1]‘?ñS[0][0]¡’ ¾ÿ¬\‘ÿô/¡’ Ä?©W[0]¡’ Î¿£|ªor“aÎ¿£BŸC?‘; ²F‘ÿ*ªor–Ûexampãle,“ÁW[1]“²i#s“a“h¸ãeqad-str*«iñÆct“ev›ÿqÇaluaÀ tÜror,“ev˜aluaÀ t¸ãinšÜrg“t˜o“wš¸ãeqak“h˜eqad“normÃal¡‘,  form,–
]anš¸ãd“t•Uh˜e“h˜eqad“ÁInt“²tÜrošGo,“if“p˜o•qs“s#ibãle.–
]ÁS[0][1]“²mš¸ãeqan“ev‘ÿqÇaluaÀ tµUe“t•Uh˜e“en±Çt˜ire“li#st¡‘,  stru•¸ãct“ure,›u¤an“d˜all˜ÁInt²s˜except˜t•Uh“e˜r•s“t.˜ÁS‘uY²(Stru•¸ãct“ure)˜ev‘ÿqÇaluaÀ tÜrors˜mÃain±Çt“ain˜t•Uh“e¡‘,  h•¸ãešqad/non-h“e˜ad›/©elem“en±Çt˜di#st“inct“ion˜so˜t•Uh“aÀ t,˜for˜exampãle,˜wh“en˜a˜li•#st˜i“s˜kno¸ãwn˜tÜroŒ‹                                         Òü gÌ\ ı¯3¤ 2Ì\ ıäÜš‘R  ²b#e›*cd•ÕTemÃan¸ãd“e•Gd˜b“ot•Uh˜tÜro˜ÁW[1]˜²an•¸ãd˜ÁS[0][1]²,˜w“e˜kno“w˜w“e˜can˜dÕTemÃan“d˜t•Uh“e˜li#st˜tÜro¤  ‘R  ÁS[1][1]–ÒÇ²(whiñÆcš¸ãh“i#s“ÁW[1]‘¸t‘3ÆÁS[0][1]‘%ó±²).“In“ot•Uh˜e
«r“w˜ords,“t•Uhi#s“m˜eqans“t•Uh˜e“h˜eqad-elem˜en±Çt¡‘R  informÃašÀ t¸ãion–.{on“a“ÁW–.q²(WHNF)“ev‘ÿqÇalua˜tÜror–.{i#s“not“(n¸ãeceGsqsar*«ily)“obãlit•µUe
«ra˜t“eGd–.{wh¸ãen“it“i#s¡‘R  com‘ÿ|qbin¸ãeGd–UUwit•Uh“an“ÁS“²ev‘ÿqÇaluaÀ tÜror.©$‘a Th•¸ãe› ªsõTc“h“em“e˜gen“e
«rali#s•1ÇeGs˜in˜s“ev•¸ãe
«ral˜direct“ions.˜Recurs#iv“e˜t“yp#eGs˜wit••Uh˜more˜t“h¸ãan¡‘R  on•¸ãe›.Ët“yp#e˜v‘ÿqÇar*«ia“bãle˜are˜mo•GdÕTelle“d˜wit••Uh˜t“h•¸ãe˜sam“e˜ÁB²/ÁW²/ÁS‘.“²coãllect“ion˜of˜pGoin±Çtà s,˜wit•Uh¡‘R  t•Uh•¸ãe›(¸ÁW‘(‚²an“d˜ÁS‘(‚²pGoin•±Çtà s˜con“t¸ãainin•Ürg˜m•Uul“t•¸ãipãle˜param“etµUe
«r*«i•#s“inÜrg˜pGoin±Çtà s,˜raÀ t••Uh¸ãe
«r˜t“h¸ãan˜just¡‘R  on•¸ãe›s8an“d˜t“w“o˜reGsp#ect“iv“ely˜as˜wit•Uh˜li#stà s.˜LaÀ tŸÿt“iñÆceGs˜for˜non-recurs#iv“e˜t“yp#eGs˜omit˜t•Uh“e¡‘R  ÁS‘¹u²pGoinš±Çtà s,–¹buÜrt“are“ot•Uh¸ãe
«rwi#s1Çe“idÕTen˜tš¸ãiñÆcal.“Cons•tru˜ctÜror“s–¹oftµUen“h˜a˜v˜e“\const˜an±Çt"“t˜yp#eGs¡‘R  {–$t•UhÃoqs1Çe“not“m•¸ãen±Çt“ioninÜrg›$t“yp#e˜v‘ÿqÇar*«ia“bãleGs˜{˜for˜arguÜrm“en±Çtà s,˜or˜h“a“v“e˜arguÜrm“en±Çtà s˜in¡‘R  whiñÆc•¸ãh›ßt•Uh“e˜t“yp#e˜v‘ÿqÇar*«ia“bãleGs˜an“d˜recurs#iv“e˜inst“anceGs˜of˜t•Uh“e˜t“yp#e˜ap“p•#eqar˜bur*«ieGd˜ins“idÕTe¡‘R  arbitrary–†§levš¸ãels“of“\in±ÇtµUe
«rv˜eninÜrg"“t˜yp#eGs.“Man˜y“programs“also“empãlo˜y“m•UuÜrt˜ually¡‘R  recursš#iv•¸ãe‘sĞt“yp˜ešGs.–sĞAll“t•Uh¸ãe˜sš1Çe“cas˜ešGs“can“b#e“h•¸ãan“dle˜d,–sĞalÜrtš•UhÃough“t˜hš¸ãey“mÃak˜e“t•Uh˜e“preci#s1Çe¡‘R“som˜et˜im˜ešGs“p˜o•qs“s#ibãle–ÒtÜro“mÃak¸ãe“a“safe“e˜st¸ãimÃaÀ tµUe“us#inÜrg¡‘,  monotÜroniñÆcit•¸ãy›UUan“d˜t•Uh“e˜informÃaÀ t“ion˜whiñÆc“h˜Äis˜²a“v‘ÿqÇaila“bãle.¡‘; F‘ÿ*ªor–ò!exampãle,“h•¸ãa“vinÜrg›ò!exp•GortµUe“d˜µG–Ìj²=“¸f²(µxŸÿ±1–|sµ;›ª¨f‘ßùxŸÿ±1“²)µ;˜²(µxŸÿ±2“µ;˜f‘ßùxŸÿ±2“²)¸g–ò!²w¸ãe“mÃay“wi#sh“tÜro¡‘,  knoš¸ãw–˜`(µf‘õxŸÿ±3‘|s²)“in“t•Uh˜e“cas1Çe“wh˜e
«re“µxŸÿ±3‘	]ğ¸v‘á}µxŸÿ±1‘	Ó²an˜d“µxŸÿ±3‘	]ğ¸v‘á}µxŸÿ±2‘|s².“Since“µf‘«ï²i#s“monotÜroniñÆc¡‘,  it–GGfoãlloš¸ãws“t•Uh˜aÀ t“µf–mâxŸÿ±3‘ÖÆ¸v‘ZSµf“xŸÿ±1‘Ãº²an˜d›GGµf“xŸÿ±3‘ÖÆ¸v‘ZSµf“xŸÿ±2‘|s²,˜an¸ãd˜so˜µf“xŸÿ±3‘ÖÆ¸v‘ZS²(µf“xŸÿ±1‘V¸u‘Ú+µf“xŸÿ±2‘|s²).¡‘,  Pro•¸ãvidÕTeGd›/õw“e˜are˜w“orà kinÜrg˜in˜a˜f*«ram“ew“orà k˜wh“e
«re˜o“v“e
«reGst“imÃaÀ t“ion˜i•#s˜safe,˜t•Uhi“s˜giv¸ãeGs¡‘,  an›UUap•¸ãpro“ximÃaÀ tµUe˜v‘ÿqÇalue˜for˜µf‘Ú§xŸÿ±3‘|s².Œ‹                                         V gÌ\ ı¯3¤ 2Ì\ ıäÜš‘a ²Cleqarly‘ÿ*ª,–üítš•Uh¸ãe“bigge
«r“t˜h¸ãe“exp•GortµUe“d–üíµG²,“t˜h¸ãe“b#etŸÿtµUe
«r“t˜hš¸ãe“e•Gst˜imÃaÀ tµUe“s–üít•Uh˜aÀ t“can“b#e“mÃadÕTe¤  ‘R  f*«rom–ÔTit.“BuÜrt“t•Uhš¸ãe“whÃoãle“purpGoqs1Çe“of“MF˜Gs“i#s“tÜro“k˜eep“µG“²as“smÃall“as“pGo•qs“s#ibãle,¡‘R  con±Çt•¸ãaininÜrg›ûp#e
«rh“apqs˜a˜h“an“dful˜of˜p‘c  tµUe
«rm–Mèanš¸ãd“t˜upãlinšÜrg“are“us1ÇeGd“t˜o“build“v‘ÿqÇaluešGs“in“liftµUe˜d“an¸ãd“pro˜d•¸ãu“ct‘MèlaÀ tŸÿt“iñÆce˜s,‘Mèan“d¡‘c  t•Uhš¸ãe
«re–=are“a“corre•Gsp“on˜dinÜrg–=s1Çet“of“\dÕTeGstru˜ct˜ionÃal"“tµUe
«rms“whiñÆc˜h“tšµUeGst“lift˜eGd-laÀ tŸÿt¸ãiñÆce¡‘c  pGoin±Çtà s–ûfor“¸?²,“uÜrnš¸ãdo“lift˜inÜrgs,“an˜d“s1Çelect“compGon˜en±Çtà s“f*«rom“t˜upãleGs.“FinÃally‘ÿ*ª,“joins¡‘c  an•¸ãd›UUm“eetà s˜of˜tµUe
«rms˜are˜allo“w“eGd.¦‘X@»{‘c  ²Thš¸ãe–LdtµUe
«rms“are“stronÜrgly-t˜ypš#eGd,“us˜inšÜrg“wh¸ãaÀ t“amou˜n±Çtà s“t˜o“an“aš¸ãbqstract“v˜e
«rs#ion¡‘c  of–îõt•Uhš¸ãe“Miln˜e
«r-Hin˜dley“t˜yp#e“systµUem.“W‘ÿ*ªell-form˜eGd“tµUe
«rms“m•Uust“b#e“w˜ell-t˜yp#eGd,¡‘c  an¸ãd–Amš•Uust“also“b#e“monotÜroniñÆc“wit˜h“reGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGsp#ect“tÜro“t˜h¸ãeGir“fš*«ree“v‘ÿqÇar˜iaš¸ãbãleGs.“Th˜e“t˜yp#e¡‘c  syst•µUem‘[3incorpšGoraÀ t“e˜s–[3a“notš¸ãion“of“param˜etr*«iñÆc“pGoãlymorphi#sm.“Th˜e“a˜bqstract“in-¡‘c  t•µUeš
«rpret“e˜r–Ôìexpãloità s“t•Uhi#s“bš¸ãy“mÃap˜pinÜrg“pGoãlymorphi#sm“in“t•Uh˜e“source“program“on±ÇtÜro¡‘c  pGoãlymorphi#sm–Ëin“t•Uhš¸ãe“a˜bqstract“tµUe
«rms,“whiñÆc˜h“giv˜ešGs“p˜oãlymorphiñÆc“anÃalys•#i“s‘Ëe˜s-¡‘c  s1Çen±Çt¸ãially–UUfor“f*«ree.¦‘X@»{‘c  ²Thš¸ãe–Y3rewr*«itµUe
«r“pro˜pš#e
«r“cons˜i˜stà s“of“a“sõTc•¸ãh“eGd“ulinÜrg‘Y3m“ec“h“ani˜sm,›Y3whiñÆc“h˜s1Çelectà s˜re-¡‘c  dÕTexeGs–6•anš¸ãd“ap˜pãliešGs“rewr*«itµUe“rule˜s“tÜro“t•Uhš¸ãem,“an˜d“t•Uh˜e“rewr*«itµUe“ruleGs“t•Uh˜ems1Çelv˜eGs.¡‘c  Th•¸ãe›asõTc“h“eGd“ule•
«r˜dÕTetµUe“rmin•¸ãeGs˜t•Uh“e˜reGd“u“ct“ion˜ordÕTe
«r,˜whiñÆc“h˜h“as˜a˜mÃa‘ 8jor˜b#eqar*«inÜrg˜on¡‘c  p#e•
«rformÃance.›·Th¸ãe“re˜are˜a•¸ãbGouÜrt˜ft“y˜ruleGs,˜mÃan“y˜wit•Uh˜compãlex˜s#idÕTe˜con“dit“ions.¡‘c  Since–®²t•Uh¸ãe“rulešGs“are“co˜dÕTe˜d“in“Haskš¸ãell,“t•Uh˜ey“can“us1Çe“t•Uh˜e“full“pGo˜w˜e
«r“of“Hask˜ell¡‘c  pa•À tŸÿtµUe
«r#n-mÃa“t•¸ãc“hinÜrg.›íTh“e˜rewr*«it•µUe
«r˜i#s˜compãliñÆcaÀ t“eGd˜som•¸ãewh“aÀ t˜b“y˜t•Uh“e˜n“eeGd˜tÜro˜pro-¡‘c  pGogaÀ tµUe–aTanš¸ãd“us1Çe“part˜ial“kno˜wleGdge“(ie,“i•#s/i“s–aTnot“¸?²)“of“t•Uh˜e“v‘ÿqÇalueGs“of“su•UbtµUe
«rms¡‘c  in–UUordÕTe
«r“tÜro“reqac¸ãh“normÃal“form.Œ‹                                         ç gÌ\ ı¯3¤ 2Ì\ ıäÜš‘,  »Makin×g–“t…Thš®9e“rewr1itª"eDr“w˜orÛ2k“w˜ell‘fÊ²Once–«a“normÃal“form“hš¸ãas“b#een“d•ÕTecid“eGd–«on“an˜d¤  ‘,  suit•¸ãa“bãle–.çrewr*«itšµUe“ruleGs“gen¸ãe
«raÀ t˜eGd,“t•Uhš¸ãe
«re“i#s“st˜ill“t•Uh˜e“i#sqsue“of“hÃo˜w“t•Uh˜e“ruleGs“are“tÜro“b#e¡‘,  ap¸ãpãliešGd.–ÂThi#s“b˜oils“doš¸ãwn“tÜro“a“proba˜b•ãly-irreconcila˜b“le–ÂconiñÆct“b#et˜w˜een“inn˜e
«rmoqst-¡‘,  r•s“t–Çcanš¸ãd“ouÜrtµUe
«rmoqs•t-r“s“t–Çcrewr*«it˜inÜrg.“Bot•Uh“straÀ tµUegieGs“w˜orà k“w˜ell“m•Uu˜c˜h“of“t•Uh˜e“t˜im˜e,¡‘,  buÜrt–¥şbGotš•Uh“also“sue
«r“f*«rom“paÀ t˜hÃoãlogiñÆcal“in±ÇtµUe
«ractš¸ãions“b#et˜w˜een“tšµUe
«rms“emitŸÿt˜eGd“b¸ãy¡‘,  t•Uh•¸ãe›°a“bqstract˜in±Çt•µUeš
«rpret“e˜r–°anš¸ãd“som˜e“of“t•Uh˜e“rewr*«itµUe“ruleGs.“In“t•Uh˜eGsš1Çe“cas˜eGs,“rewr*«it¸ãinÜrg¡‘,  can›pØt•¸ãak“e˜a˜smÃall˜tµUe
«rm˜an“d˜expan“d˜it˜expGon“en±Çt“ially˜tÜro˜a˜gigan±Çt“iñÆc˜in±ÇtšµUe
«rm“eGdiaÀ t˜e¡‘,  tµUe
«rm–Ånb#efore“empãloš¸ãyinÜrg“som˜e“ot•Uh˜e
«r“rule“tšÜro“shr*«ink“it“t˜o“anot•Uh¸ãeš
«r“smÃall“tµUe˜rm.“Th¸ãe¡‘,  eect–ªñon“pš#e
«rformÃance“i˜s“di˜sastrous.“GetŸÿt¸ãinšÜrg“rou˜nš¸ãd“t•Uhi#s“probãlem“requireGs“a“h˜ybr*«id¡‘,  rešGd•¸ãu“ct“ion–YĞstraÀ tµUegy“whiñÆc¸ãh“tr*«ie˜s“tÜro“a•¸ãv“oid›YĞkno“wn˜paÀ t•UhÃoãlogiñÆcal˜cas1ÇeGs.˜Thi#s˜w“orà ks˜w“ell,¡‘,  al•Ürt•UhÃough›'©dÕTecidin“g˜on˜t•Uh¸ãe˜spãlit˜requireGs˜a˜gre•qaÀ t˜dÕTe“al˜of˜dÕTet•¸ãaileGd˜in“v“eGst“igaÀ t“ion˜in±ÇtÜro¡‘,  tš•Uh¸ãe–UUpreci#s1Çe“dynÃamiñÆcs“of“t˜hš¸ãe“reGd˜u˜ct˜ion“systµUem“as“ap˜pãlieGd“tÜro“reqali#st˜iñÆc“w˜orà kloads.©Âó‘; W‘ÿ*ªaÀ t•¸ãc“hinÜrg›wÅt•Uh“e˜rewr*«itµUe
«r˜aÀ t˜w“orà k˜rev“eqaleGd˜anot•Uh“e•
«r˜in±ÇtµUe“reGst¸ãin•Ürg,˜bu“t,˜in˜retroqsp#ect,¡‘,  ušÜrnsurpr*«i•#s“in˜g›Æ‡f“act:˜t•Uh•¸ãe˜a“bqstract˜in±Çt•µUeš
«rpret“e˜r's›Æ‡\v•¸ãoGca“bulary"˜of˜tµUe
«rm-com‘ÿ|qbinÃaÀ t“ions¡‘,  emitŸÿtšµUeGd–˜…i#s“part¸ãiñÆcularly“limit˜eGd.“Thš¸ãe“sam˜e“smÃall“coãllect˜ion“of“idioms“oGccurs“o˜v˜e
«r¡‘,  an•¸ãd›˜“o“v“e
«r˜again.˜Som“e˜of˜t•Uh“eGs1Çe˜idioms˜are˜extrem“ely˜common,˜buÜrt˜t•Uh“ey˜are˜also¡‘,  quitšµUe–õbig.“Big“t˜eš
«rms“are“a“p#e˜rformÃance“lia•¸ãbilit“y;›õcons•#i“st•µUen±Çt•Uly˜smÃall˜t“e
«rms˜t“en¸ãd˜tÜro¡‘,  giv•¸ãe›¬m•Uu“c“h˜b•#etŸÿtµUe
«r˜p“e
«rform•Ãance.˜Th¸ãaÀ t˜m“ak•¸ãeGs˜it˜aÀ tŸÿtract“iv“e˜tÜro˜capt“ure˜su“c“h˜idioms¡‘,  in–Ôÿsp#ecial,“nš¸ãew“tµUe
«rms,“an˜d“adjust“t•Uh˜e“rewr*«itµUe“ruleGs“accordinÜrgly‘ÿ*ª.“Thiš#s“shÃould“b˜e¡‘,  donš¸ãe–Õïspar*«inÜrgly‘ÿ*ª,“s#ince“t•Uh˜e“tšµUe
«rm“rewr*«it˜e
«r“b#ecom¸ãeGs“compãliñÆcaÀ t˜eGd“bš¸ãy“h˜a˜vinšÜrg“t˜o“dÕTeqal¡‘,  wit••Uh›Óm“ulÜrt•¸ãipãle˜repreGs1Çen±Çt“aÀ t“ions˜of˜t•Uh“e˜sam“e˜tµUe
«rm.˜St“ill,˜capt“ur*«inÜrg˜just˜t“w“o˜common¡‘,  idioms–ƒ„likš¸ãe“t•Uhi#s“h˜as“giv˜en“p#e
«rformÃance“gains“v˜e
«ry“roughly“on“t•Uh˜e“ordÕTe
«r“of“25¡‘,  t•¸ãim“eGs–UU?or“som¸ãe“inpuÜrtà s.¦‘; Ev¸ãen–?witš•Uh“t˜hi#s“tr*«iñÆc•¸ãk“e
«ry‘ÿ*ª,‘?t˜h“e›?a“bqstract˜in±Çt•µUeš
«rpret“e˜r–?can“som•¸ãet“im“eGs–?emit“tµUe˜rms“so¡‘,  large–®ªt•Uhš¸ãey“sw˜amp“t•Uh˜e“rewr*«itµUe
«r.“In“t•Uhiš#s“s˜it•¸ãuaÀ t“ion–®ªit“i˜s“h¸ãelpful“tÜro“dÕTevi˜s1Çe“a“w¸ãay“tÜro¡‘,  pruÜrnš¸ãe–™çtµUe
«rms“so“t•Uh˜e“moqst“impGort˜an±Çt“informÃaÀ t˜ion“i#s“ret˜ain˜eGd,“whilst“dramÃaÀ t˜iñÆcally¡‘,  shr*«inkinšÜrg–ªğt•Uh¸ãe“tµUe
«rm.“Of“cours1Çe,“dÕTenin˜g“wh¸ãašÀ t“informÃa˜tš¸ãion“i#s“impGort˜an±Çt“an˜d“hÃo˜w¡‘,  safetš¸ãy–.€i#s“pre•Gs1Çe
«rv˜e“d–.€dÕTep#en˜ds“en±Çt˜irely“on“t•Uh˜e“a˜bqstract“in±ÇtµUe
«rpret˜aÀ t˜ion.“F‘ÿ*ªor“t•Uhi#s“kin˜d¡‘,  of–KÒstr*«iñÆctnš¸ãeGsqs“anÃalys•#i“s,–KÒit“i#s“safe“tÜro“repãlace“an˜y“tµUe
«rm“b˜y“¸?²,“s#ince“¸?“²c˜h˜aractµUe
«r*«i#s1ÇeGs“\no¡‘,  dÕTemÃan•¸ãd".›ÊòTh“e˜sõTc“h“em“e˜empãlo“y“eGd˜pruÜrn“eGs˜t•µUe
«rms˜aft“e
«r˜a˜sp#ecie•Gd˜dÕTept•Uh˜of˜n¸ãe“stµUe“d¡‘,  ÁW–Ú8²or›Ú[Á